{"dependencies":[{"name":"./on-next-frame.mjs","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":67,"index":67}}],"key":"6FI1rezAbomF7E9+jncvacSaiQo=","exportNames":["*"],"imports":1}},{"name":"./create-render-step.mjs","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":68},"end":{"line":2,"column":60,"index":128}}],"key":"UaCUZ/fKCOq61vl4rOEnIopX2nk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"cancelSync\", {\n    enumerable: true,\n    get: function () {\n      return cancelSync;\n    }\n  });\n  Object.defineProperty(exports, \"flushSync\", {\n    enumerable: true,\n    get: function () {\n      return flushSync;\n    }\n  });\n  Object.defineProperty(exports, \"getFrameData\", {\n    enumerable: true,\n    get: function () {\n      return getFrameData;\n    }\n  });\n  var _onNextFrameMjs = require(_dependencyMap[0], \"./on-next-frame.mjs\");\n  var _createRenderStepMjs = require(_dependencyMap[1], \"./create-render-step.mjs\");\n  var maxElapsed = 40;\n  var useDefaultElapsed = true;\n  var runNextFrame = false;\n  var isProcessing = false;\n  var frame = {\n    delta: 0,\n    timestamp: 0\n  };\n  var stepsOrder = [\"read\", \"update\", \"preRender\", \"render\", \"postRender\"];\n  var steps = stepsOrder.reduce((acc, key) => {\n    acc[key] = (0, _createRenderStepMjs.createRenderStep)(() => runNextFrame = true);\n    return acc;\n  }, {});\n  var sync = stepsOrder.reduce((acc, key) => {\n    var step = steps[key];\n    acc[key] = function (process) {\n      var keepAlive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var immediate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      if (!runNextFrame) startLoop();\n      return step.schedule(process, keepAlive, immediate);\n    };\n    return acc;\n  }, {});\n  var cancelSync = stepsOrder.reduce((acc, key) => {\n    acc[key] = steps[key].cancel;\n    return acc;\n  }, {});\n  var flushSync = stepsOrder.reduce((acc, key) => {\n    acc[key] = () => steps[key].process(frame);\n    return acc;\n  }, {});\n  var processStep = stepId => steps[stepId].process(frame);\n  var processFrame = timestamp => {\n    runNextFrame = false;\n    frame.delta = useDefaultElapsed ? _onNextFrameMjs.defaultTimestep : Math.max(Math.min(timestamp - frame.timestamp, maxElapsed), 1);\n    frame.timestamp = timestamp;\n    isProcessing = true;\n    stepsOrder.forEach(processStep);\n    isProcessing = false;\n    if (runNextFrame) {\n      useDefaultElapsed = false;\n      (0, _onNextFrameMjs.onNextFrame)(processFrame);\n    }\n  };\n  var startLoop = () => {\n    runNextFrame = true;\n    useDefaultElapsed = true;\n    if (!isProcessing) (0, _onNextFrameMjs.onNextFrame)(processFrame);\n  };\n  var getFrameData = () => frame;\n  var _default = sync;\n});","lineCount":84,"map":[[7,2,63,0,"Object"],[7,8,63,0],[7,9,63,0,"defineProperty"],[7,23,63,0],[7,24,63,0,"exports"],[7,31,63,0],[8,4,63,0,"enumerable"],[8,14,63,0],[9,4,63,0,"get"],[9,7,63,0],[9,18,63,0,"get"],[9,19,63,0],[10,6,63,0],[10,13,63,0,"_default"],[10,21,63,0],[11,4,63,0],[12,2,63,0],[13,2,64,0,"Object"],[13,8,64,0],[13,9,64,0,"defineProperty"],[13,23,64,0],[13,24,64,0,"exports"],[13,31,64,0],[14,4,64,0,"enumerable"],[14,14,64,0],[15,4,64,0,"get"],[15,7,64,0],[15,18,64,0,"get"],[15,19,64,0],[16,6,64,0],[16,13,64,9,"cancelSync"],[16,23,64,19],[17,4,64,19],[18,2,64,19],[19,2,64,0,"Object"],[19,8,64,0],[19,9,64,0,"defineProperty"],[19,23,64,0],[19,24,64,0,"exports"],[19,31,64,0],[20,4,64,0,"enumerable"],[20,14,64,0],[21,4,64,0,"get"],[21,7,64,0],[21,18,64,0,"get"],[21,19,64,0],[22,6,64,0],[22,13,64,21,"flushSync"],[22,22,64,30],[23,4,64,30],[24,2,64,30],[25,2,64,0,"Object"],[25,8,64,0],[25,9,64,0,"defineProperty"],[25,23,64,0],[25,24,64,0,"exports"],[25,31,64,0],[26,4,64,0,"enumerable"],[26,14,64,0],[27,4,64,0,"get"],[27,7,64,0],[27,18,64,0,"get"],[27,19,64,0],[28,6,64,0],[28,13,64,32,"getFrameData"],[28,25,64,44],[29,4,64,44],[30,2,64,44],[31,2,1,0],[31,6,1,0,"_onNextFrameMjs"],[31,21,1,0],[31,24,1,0,"require"],[31,31,1,0],[31,32,1,0,"_dependencyMap"],[31,46,1,0],[32,2,2,0],[32,6,2,0,"_createRenderStepMjs"],[32,26,2,0],[32,29,2,0,"require"],[32,36,2,0],[32,37,2,0,"_dependencyMap"],[32,51,2,0],[33,2,4,0],[33,6,4,6,"maxElapsed"],[33,16,4,16],[33,19,4,19],[33,21,4,21],[34,2,5,0],[34,6,5,4,"useDefaultElapsed"],[34,23,5,21],[34,26,5,24],[34,30,5,28],[35,2,6,0],[35,6,6,4,"runNextFrame"],[35,18,6,16],[35,21,6,19],[35,26,6,24],[36,2,7,0],[36,6,7,4,"isProcessing"],[36,18,7,16],[36,21,7,19],[36,26,7,24],[37,2,8,0],[37,6,8,6,"frame"],[37,11,8,11],[37,14,8,14],[38,4,9,4,"delta"],[38,9,9,9],[38,11,9,11],[38,12,9,12],[39,4,10,4,"timestamp"],[39,13,10,13],[39,15,10,15],[40,2,11,0],[40,3,11,1],[41,2,12,0],[41,6,12,6,"stepsOrder"],[41,16,12,16],[41,19,12,19],[41,20,13,4],[41,26,13,10],[41,28,14,4],[41,36,14,12],[41,38,15,4],[41,49,15,15],[41,51,16,4],[41,59,16,12],[41,61,17,4],[41,73,17,16],[41,74,18,1],[42,2,19,0],[42,6,19,6,"steps"],[42,11,19,11],[42,14,19,14,"stepsOrder"],[42,24,19,24],[42,25,19,25,"reduce"],[42,31,19,31],[42,32,19,32],[42,33,19,33,"acc"],[42,36,19,36],[42,38,19,38,"key"],[42,41,19,41],[42,46,19,46],[43,4,20,4,"acc"],[43,7,20,7],[43,8,20,8,"key"],[43,11,20,11],[43,12,20,12],[43,15,20,15],[43,19,20,15,"createRenderStep"],[43,39,20,31],[43,40,20,31,"createRenderStep"],[43,56,20,31],[43,58,20,32],[43,64,20,39,"runNextFrame"],[43,76,20,51],[43,79,20,54],[43,83,20,59],[43,84,20,60],[44,4,21,4],[44,11,21,11,"acc"],[44,14,21,14],[45,2,22,0],[45,3,22,1],[45,5,22,3],[45,6,22,4],[45,7,22,5],[45,8,22,6],[46,2,23,0],[46,6,23,6,"sync"],[46,10,23,10],[46,13,23,13,"stepsOrder"],[46,23,23,23],[46,24,23,24,"reduce"],[46,30,23,30],[46,31,23,31],[46,32,23,32,"acc"],[46,35,23,35],[46,37,23,37,"key"],[46,40,23,40],[46,45,23,45],[47,4,24,4],[47,8,24,10,"step"],[47,12,24,14],[47,15,24,17,"steps"],[47,20,24,22],[47,21,24,23,"key"],[47,24,24,26],[47,25,24,27],[48,4,25,4,"acc"],[48,7,25,7],[48,8,25,8,"key"],[48,11,25,11],[48,12,25,12],[48,15,25,15],[48,25,25,16,"process"],[48,32,25,23],[48,34,25,66],[49,6,25,66],[49,10,25,25,"keepAlive"],[49,19,25,34],[49,22,25,34,"arguments"],[49,31,25,34],[49,32,25,34,"length"],[49,38,25,34],[49,46,25,34,"arguments"],[49,55,25,34],[49,63,25,34,"undefined"],[49,72,25,34],[49,75,25,34,"arguments"],[49,84,25,34],[49,90,25,37],[49,95,25,42],[50,6,25,42],[50,10,25,44,"immediate"],[50,19,25,53],[50,22,25,53,"arguments"],[50,31,25,53],[50,32,25,53,"length"],[50,38,25,53],[50,46,25,53,"arguments"],[50,55,25,53],[50,63,25,53,"undefined"],[50,72,25,53],[50,75,25,53,"arguments"],[50,84,25,53],[50,90,25,56],[50,95,25,61],[51,6,26,8],[51,10,26,12],[51,11,26,13,"runNextFrame"],[51,23,26,25],[51,25,27,12,"startLoop"],[51,34,27,21],[51,35,27,22],[51,36,27,23],[52,6,28,8],[52,13,28,15,"step"],[52,17,28,19],[52,18,28,20,"schedule"],[52,26,28,28],[52,27,28,29,"process"],[52,34,28,36],[52,36,28,38,"keepAlive"],[52,45,28,47],[52,47,28,49,"immediate"],[52,56,28,58],[52,57,28,59],[53,4,29,4],[53,5,29,5],[54,4,30,4],[54,11,30,11,"acc"],[54,14,30,14],[55,2,31,0],[55,3,31,1],[55,5,31,3],[55,6,31,4],[55,7,31,5],[55,8,31,6],[56,2,32,0],[56,6,32,6,"cancelSync"],[56,16,32,16],[56,19,32,19,"stepsOrder"],[56,29,32,29],[56,30,32,30,"reduce"],[56,36,32,36],[56,37,32,37],[56,38,32,38,"acc"],[56,41,32,41],[56,43,32,43,"key"],[56,46,32,46],[56,51,32,51],[57,4,33,4,"acc"],[57,7,33,7],[57,8,33,8,"key"],[57,11,33,11],[57,12,33,12],[57,15,33,15,"steps"],[57,20,33,20],[57,21,33,21,"key"],[57,24,33,24],[57,25,33,25],[57,26,33,26,"cancel"],[57,32,33,32],[58,4,34,4],[58,11,34,11,"acc"],[58,14,34,14],[59,2,35,0],[59,3,35,1],[59,5,35,3],[59,6,35,4],[59,7,35,5],[59,8,35,6],[60,2,36,0],[60,6,36,6,"flushSync"],[60,15,36,15],[60,18,36,18,"stepsOrder"],[60,28,36,28],[60,29,36,29,"reduce"],[60,35,36,35],[60,36,36,36],[60,37,36,37,"acc"],[60,40,36,40],[60,42,36,42,"key"],[60,45,36,45],[60,50,36,50],[61,4,37,4,"acc"],[61,7,37,7],[61,8,37,8,"key"],[61,11,37,11],[61,12,37,12],[61,15,37,15],[61,21,37,21,"steps"],[61,26,37,26],[61,27,37,27,"key"],[61,30,37,30],[61,31,37,31],[61,32,37,32,"process"],[61,39,37,39],[61,40,37,40,"frame"],[61,45,37,45],[61,46,37,46],[62,4,38,4],[62,11,38,11,"acc"],[62,14,38,14],[63,2,39,0],[63,3,39,1],[63,5,39,3],[63,6,39,4],[63,7,39,5],[63,8,39,6],[64,2,40,0],[64,6,40,6,"processStep"],[64,17,40,17],[64,20,40,21,"stepId"],[64,26,40,27],[64,30,40,32,"steps"],[64,35,40,37],[64,36,40,38,"stepId"],[64,42,40,44],[64,43,40,45],[64,44,40,46,"process"],[64,51,40,53],[64,52,40,54,"frame"],[64,57,40,59],[64,58,40,60],[65,2,41,0],[65,6,41,6,"processFrame"],[65,18,41,18],[65,21,41,22,"timestamp"],[65,30,41,31],[65,34,41,36],[66,4,42,4,"runNextFrame"],[66,16,42,16],[66,19,42,19],[66,24,42,24],[67,4,43,4,"frame"],[67,9,43,9],[67,10,43,10,"delta"],[67,15,43,15],[67,18,43,18,"useDefaultElapsed"],[67,35,43,35],[67,38,44,10,"defaultTimestep"],[67,53,44,25],[67,54,44,25,"defaultTimestep"],[67,69,44,25],[67,72,45,10,"Math"],[67,76,45,14],[67,77,45,15,"max"],[67,80,45,18],[67,81,45,19,"Math"],[67,85,45,23],[67,86,45,24,"min"],[67,89,45,27],[67,90,45,28,"timestamp"],[67,99,45,37],[67,102,45,40,"frame"],[67,107,45,45],[67,108,45,46,"timestamp"],[67,117,45,55],[67,119,45,57,"maxElapsed"],[67,129,45,67],[67,130,45,68],[67,132,45,70],[67,133,45,71],[67,134,45,72],[68,4,46,4,"frame"],[68,9,46,9],[68,10,46,10,"timestamp"],[68,19,46,19],[68,22,46,22,"timestamp"],[68,31,46,31],[69,4,47,4,"isProcessing"],[69,16,47,16],[69,19,47,19],[69,23,47,23],[70,4,48,4,"stepsOrder"],[70,14,48,14],[70,15,48,15,"forEach"],[70,22,48,22],[70,23,48,23,"processStep"],[70,34,48,34],[70,35,48,35],[71,4,49,4,"isProcessing"],[71,16,49,16],[71,19,49,19],[71,24,49,24],[72,4,50,4],[72,8,50,8,"runNextFrame"],[72,20,50,20],[72,22,50,22],[73,6,51,8,"useDefaultElapsed"],[73,23,51,25],[73,26,51,28],[73,31,51,33],[74,6,52,8],[74,10,52,8,"onNextFrame"],[74,25,52,19],[74,26,52,19,"onNextFrame"],[74,37,52,19],[74,39,52,20,"processFrame"],[74,51,52,32],[74,52,52,33],[75,4,53,4],[76,2,54,0],[76,3,54,1],[77,2,55,0],[77,6,55,6,"startLoop"],[77,15,55,15],[77,18,55,18,"startLoop"],[77,19,55,18],[77,24,55,24],[78,4,56,4,"runNextFrame"],[78,16,56,16],[78,19,56,19],[78,23,56,23],[79,4,57,4,"useDefaultElapsed"],[79,21,57,21],[79,24,57,24],[79,28,57,28],[80,4,58,4],[80,8,58,8],[80,9,58,9,"isProcessing"],[80,21,58,21],[80,23,59,8],[80,27,59,8,"onNextFrame"],[80,42,59,19],[80,43,59,19,"onNextFrame"],[80,54,59,19],[80,56,59,20,"processFrame"],[80,68,59,32],[80,69,59,33],[81,2,60,0],[81,3,60,1],[82,2,61,0],[82,6,61,6,"getFrameData"],[82,18,61,18],[82,21,61,21,"getFrameData"],[82,22,61,21],[82,27,61,27,"frame"],[82,32,61,32],[83,2,63,0],[83,6,63,0,"_default"],[83,14,63,0],[83,17,63,15,"sync"],[83,21,63,19],[84,0,63,20],[84,3]],"functionMap":{"names":["<global>","stepsOrder.reduce$argument_0","createRenderStep$argument_0","acc.key","processStep","processFrame","startLoop","getFrameData"],"mappings":"AAA;gCCkB;gCCC,2BD;CDE;+BCC;eEE;KFI;CDE;qCCC;CDG;oCCC;eEC,+BF;CDE;oBIC,wCJ;qBKC;CLa;kBMC;CNK;qBOC,WP"},"hasCjsExports":false},"type":"js/module"}]}