{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"./secureStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":81,"index":115}}],"key":"i/WIxrqWIisp/TkVGUz2jt3I0zA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"authKey\", {\n    enumerable: true,\n    get: function () {\n      return authKey;\n    }\n  });\n  Object.defineProperty(exports, \"userCacheKey\", {\n    enumerable: true,\n    get: function () {\n      return userCacheKey;\n    }\n  });\n  Object.defineProperty(exports, \"useAuthStore\", {\n    enumerable: true,\n    get: function () {\n      return useAuthStore;\n    }\n  });\n  Object.defineProperty(exports, \"useUserStore\", {\n    enumerable: true,\n    get: function () {\n      return useUserStore;\n    }\n  });\n  Object.defineProperty(exports, \"useAuthModal\", {\n    enumerable: true,\n    get: function () {\n      return useAuthModal;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _zustand = require(_dependencyMap[1], \"zustand\");\n  var _secureStorage = require(_dependencyMap[2], \"./secureStorage\");\n  const authKey = `${_expoVirtualEnv.env.EXPO_PUBLIC_PROJECT_GROUP_ID}-jwt`;\n  const userCacheKey = `${_expoVirtualEnv.env.EXPO_PUBLIC_PROJECT_GROUP_ID}-user-cache`;\n\n  /**\n   * This store manages the authentication state of the application.\n   */\n  const useAuthStore = (0, _zustand.create)(set => ({\n    isReady: false,\n    auth: null,\n    setAuth: auth => {\n      if (auth) {\n        (0, _secureStorage.secureSetItem)(authKey, JSON.stringify(auth));\n      } else {\n        (0, _secureStorage.secureDeleteItem)(authKey);\n      }\n      set({\n        auth\n      });\n    }\n  }));\n\n  /**\n   * This store manages the user data and caching.\n   */\n  const useUserStore = (0, _zustand.create)((set, get) => ({\n    user: null,\n    isLoading: false,\n    error: null,\n    lastFetchTime: null,\n    cacheExpiry: 5 * 60 * 1000,\n    // 5 minutes in milliseconds\n\n    // Set user data and update cache\n    setUser: user => {\n      if (user) {\n        const userData = {\n          ...user,\n          _timestamp: Date.now()\n        };\n        (0, _secureStorage.secureSetItem)(userCacheKey, JSON.stringify(userData));\n        set({\n          user: userData,\n          lastFetchTime: Date.now(),\n          error: null\n        });\n      } else {\n        (0, _secureStorage.secureDeleteItem)(userCacheKey);\n        set({\n          user: null,\n          lastFetchTime: null,\n          error: null\n        });\n      }\n    },\n    // Load user from cache\n    loadUserFromCache: async () => {\n      try {\n        const cachedUser = await (0, _secureStorage.secureGetItem)(userCacheKey);\n        if (cachedUser) {\n          const userData = JSON.parse(cachedUser);\n          const {\n            _timestamp,\n            ...user\n          } = userData;\n          const now = Date.now();\n          const {\n            cacheExpiry\n          } = get();\n\n          // Check if cache is still valid\n          if (_timestamp && now - _timestamp < cacheExpiry) {\n            set({\n              user: userData,\n              lastFetchTime: _timestamp,\n              error: null\n            });\n            return user;\n          } else {\n            // Cache expired, clear it\n            (0, _secureStorage.secureDeleteItem)(userCacheKey);\n            set({\n              user: null,\n              lastFetchTime: null,\n              error: null\n            });\n          }\n        }\n        return null;\n      } catch (error) {\n        console.error('Error loading user from cache:', error);\n        set({\n          error: 'Failed to load user data from cache'\n        });\n        return null;\n      }\n    },\n    // Clear user data and cache\n    clearUser: () => {\n      (0, _secureStorage.secureDeleteItem)(userCacheKey);\n      set({\n        user: null,\n        lastFetchTime: null,\n        error: null\n      });\n    },\n    // Set loading state\n    setLoading: isLoading => {\n      set({\n        isLoading\n      });\n    },\n    // Set error state\n    setError: error => {\n      set({\n        error\n      });\n    }\n  }));\n\n  /**\n   * This store manages the state of the authentication modal.\n   */\n  const useAuthModal = (0, _zustand.create)(set => ({\n    isOpen: false,\n    mode: 'signup',\n    open: options => set({\n      isOpen: true,\n      mode: options?.mode || 'signup'\n    }),\n    close: () => set({\n      isOpen: false\n    })\n  }));\n});","lineCount":173,"map":[[7,2,4,0,"Object"],[7,8,4,0],[7,9,4,0,"defineProperty"],[7,23,4,0],[7,24,4,0,"exports"],[7,31,4,0],[8,4,4,0,"enumerable"],[8,14,4,0],[9,4,4,0,"get"],[9,7,4,0],[9,18,4,0,"get"],[9,19,4,0],[10,6,4,0],[10,13,4,0,"authKey"],[10,20,4,0],[11,4,4,0],[12,2,4,0],[13,2,5,0,"Object"],[13,8,5,0],[13,9,5,0,"defineProperty"],[13,23,5,0],[13,24,5,0,"exports"],[13,31,5,0],[14,4,5,0,"enumerable"],[14,14,5,0],[15,4,5,0,"get"],[15,7,5,0],[15,18,5,0,"get"],[15,19,5,0],[16,6,5,0],[16,13,5,0,"userCacheKey"],[16,25,5,0],[17,4,5,0],[18,2,5,0],[19,2,10,0,"Object"],[19,8,10,0],[19,9,10,0,"defineProperty"],[19,23,10,0],[19,24,10,0,"exports"],[19,31,10,0],[20,4,10,0,"enumerable"],[20,14,10,0],[21,4,10,0,"get"],[21,7,10,0],[21,18,10,0,"get"],[21,19,10,0],[22,6,10,0],[22,13,10,0,"useAuthStore"],[22,25,10,0],[23,4,10,0],[24,2,10,0],[25,2,26,0,"Object"],[25,8,26,0],[25,9,26,0,"defineProperty"],[25,23,26,0],[25,24,26,0,"exports"],[25,31,26,0],[26,4,26,0,"enumerable"],[26,14,26,0],[27,4,26,0,"get"],[27,7,26,0],[27,18,26,0,"get"],[27,19,26,0],[28,6,26,0],[28,13,26,0,"useUserStore"],[28,25,26,0],[29,4,26,0],[30,2,26,0],[31,2,116,0,"Object"],[31,8,116,0],[31,9,116,0,"defineProperty"],[31,23,116,0],[31,24,116,0,"exports"],[31,31,116,0],[32,4,116,0,"enumerable"],[32,14,116,0],[33,4,116,0,"get"],[33,7,116,0],[33,18,116,0,"get"],[33,19,116,0],[34,6,116,0],[34,13,116,0,"useAuthModal"],[34,25,116,0],[35,4,116,0],[36,2,116,0],[37,2,121,4],[37,6,121,4,"_expoVirtualEnv"],[37,21,121,4],[37,24,121,4,"require"],[37,31,121,4],[37,32,121,4,"_dependencyMap"],[37,46,121,4],[38,2,1,0],[38,6,1,0,"_zustand"],[38,14,1,0],[38,17,1,0,"require"],[38,24,1,0],[38,25,1,0,"_dependencyMap"],[38,39,1,0],[39,2,2,0],[39,6,2,0,"_secureStorage"],[39,20,2,0],[39,23,2,0,"require"],[39,30,2,0],[39,31,2,0,"_dependencyMap"],[39,45,2,0],[40,2,4,7],[40,8,4,13,"authKey"],[40,15,4,20],[40,18,4,23],[40,21,4,23,"_expoVirtualEnv"],[40,36,4,23],[40,37,4,23,"env"],[40,40,4,23],[40,41,4,23,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[40,69,4,23],[40,75,4,72],[41,2,5,7],[41,8,5,13,"userCacheKey"],[41,20,5,25],[41,23,5,28],[41,26,5,28,"_expoVirtualEnv"],[41,41,5,28],[41,42,5,28,"env"],[41,45,5,28],[41,46,5,28,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[41,74,5,28],[41,87,5,84],[43,2,7,0],[44,0,8,0],[45,0,9,0],[46,2,10,7],[46,8,10,13,"useAuthStore"],[46,20,10,25],[46,23,10,28],[46,27,10,28,"create"],[46,35,10,34],[46,36,10,34,"create"],[46,42,10,34],[46,44,10,36,"set"],[46,47,10,39],[46,52,10,45],[47,4,11,2,"isReady"],[47,11,11,9],[47,13,11,11],[47,18,11,16],[48,4,12,2,"auth"],[48,8,12,6],[48,10,12,8],[48,14,12,12],[49,4,13,2,"setAuth"],[49,11,13,9],[49,13,13,12,"auth"],[49,17,13,16],[49,21,13,21],[50,6,14,4],[50,10,14,8,"auth"],[50,14,14,12],[50,16,14,14],[51,8,15,6],[51,12,15,6,"secureSetItem"],[51,26,15,19],[51,27,15,19,"secureSetItem"],[51,40,15,19],[51,42,15,20,"authKey"],[51,49,15,27],[51,51,15,29,"JSON"],[51,55,15,33],[51,56,15,34,"stringify"],[51,65,15,43],[51,66,15,44,"auth"],[51,70,15,48],[51,71,15,49],[51,72,15,50],[52,6,16,4],[52,7,16,5],[52,13,16,11],[53,8,17,6],[53,12,17,6,"secureDeleteItem"],[53,26,17,22],[53,27,17,22,"secureDeleteItem"],[53,43,17,22],[53,45,17,23,"authKey"],[53,52,17,30],[53,53,17,31],[54,6,18,4],[55,6,19,4,"set"],[55,9,19,7],[55,10,19,8],[56,8,19,10,"auth"],[57,6,19,15],[57,7,19,16],[57,8,19,17],[58,4,20,2],[59,2,21,0],[59,3,21,1],[59,4,21,2],[59,5,21,3],[61,2,23,0],[62,0,24,0],[63,0,25,0],[64,2,26,7],[64,8,26,13,"useUserStore"],[64,20,26,25],[64,23,26,28],[64,27,26,28,"create"],[64,35,26,34],[64,36,26,34,"create"],[64,42,26,34],[64,44,26,35],[64,45,26,36,"set"],[64,48,26,39],[64,50,26,41,"get"],[64,53,26,44],[64,59,26,50],[65,4,27,2,"user"],[65,8,27,6],[65,10,27,8],[65,14,27,12],[66,4,28,2,"isLoading"],[66,13,28,11],[66,15,28,13],[66,20,28,18],[67,4,29,2,"error"],[67,9,29,7],[67,11,29,9],[67,15,29,13],[68,4,30,2,"lastFetchTime"],[68,17,30,15],[68,19,30,17],[68,23,30,21],[69,4,31,2,"cacheExpiry"],[69,15,31,13],[69,17,31,15],[69,18,31,16],[69,21,31,19],[69,23,31,21],[69,26,31,24],[69,30,31,28],[70,4,31,30],[72,4,33,2],[73,4,34,2,"setUser"],[73,11,34,9],[73,13,34,12,"user"],[73,17,34,16],[73,21,34,21],[74,6,35,4],[74,10,35,8,"user"],[74,14,35,12],[74,16,35,14],[75,8,36,6],[75,14,36,12,"userData"],[75,22,36,20],[75,25,36,23],[76,10,37,8],[76,13,37,11,"user"],[76,17,37,15],[77,10,38,8,"_timestamp"],[77,20,38,18],[77,22,38,20,"Date"],[77,26,38,24],[77,27,38,25,"now"],[77,30,38,28],[77,31,38,29],[78,8,39,6],[78,9,39,7],[79,8,40,6],[79,12,40,6,"secureSetItem"],[79,26,40,19],[79,27,40,19,"secureSetItem"],[79,40,40,19],[79,42,40,20,"userCacheKey"],[79,54,40,32],[79,56,40,34,"JSON"],[79,60,40,38],[79,61,40,39,"stringify"],[79,70,40,48],[79,71,40,49,"userData"],[79,79,40,57],[79,80,40,58],[79,81,40,59],[80,8,41,6,"set"],[80,11,41,9],[80,12,41,10],[81,10,42,8,"user"],[81,14,42,12],[81,16,42,14,"userData"],[81,24,42,22],[82,10,43,8,"lastFetchTime"],[82,23,43,21],[82,25,43,23,"Date"],[82,29,43,27],[82,30,43,28,"now"],[82,33,43,31],[82,34,43,32],[82,35,43,33],[83,10,44,8,"error"],[83,15,44,13],[83,17,44,15],[84,8,45,6],[84,9,45,7],[84,10,45,8],[85,6,46,4],[85,7,46,5],[85,13,46,11],[86,8,47,6],[86,12,47,6,"secureDeleteItem"],[86,26,47,22],[86,27,47,22,"secureDeleteItem"],[86,43,47,22],[86,45,47,23,"userCacheKey"],[86,57,47,35],[86,58,47,36],[87,8,48,6,"set"],[87,11,48,9],[87,12,48,10],[88,10,49,8,"user"],[88,14,49,12],[88,16,49,14],[88,20,49,18],[89,10,50,8,"lastFetchTime"],[89,23,50,21],[89,25,50,23],[89,29,50,27],[90,10,51,8,"error"],[90,15,51,13],[90,17,51,15],[91,8,52,6],[91,9,52,7],[91,10,52,8],[92,6,53,4],[93,4,54,2],[93,5,54,3],[94,4,56,2],[95,4,57,2,"loadUserFromCache"],[95,21,57,19],[95,23,57,21],[95,29,57,21,"loadUserFromCache"],[95,30,57,21],[95,35,57,33],[96,6,58,4],[96,10,58,8],[97,8,59,6],[97,14,59,12,"cachedUser"],[97,24,59,22],[97,27,59,25],[97,33,59,31],[97,37,59,31,"secureGetItem"],[97,51,59,44],[97,52,59,44,"secureGetItem"],[97,65,59,44],[97,67,59,45,"userCacheKey"],[97,79,59,57],[97,80,59,58],[98,8,60,6],[98,12,60,10,"cachedUser"],[98,22,60,20],[98,24,60,22],[99,10,61,8],[99,16,61,14,"userData"],[99,24,61,22],[99,27,61,25,"JSON"],[99,31,61,29],[99,32,61,30,"parse"],[99,37,61,35],[99,38,61,36,"cachedUser"],[99,48,61,46],[99,49,61,47],[100,10,62,8],[100,16,62,14],[101,12,62,16,"_timestamp"],[101,22,62,26],[102,12,62,28],[102,15,62,31,"user"],[103,10,62,36],[103,11,62,37],[103,14,62,40,"userData"],[103,22,62,48],[104,10,63,8],[104,16,63,14,"now"],[104,19,63,17],[104,22,63,20,"Date"],[104,26,63,24],[104,27,63,25,"now"],[104,30,63,28],[104,31,63,29],[104,32,63,30],[105,10,64,8],[105,16,64,14],[106,12,64,16,"cacheExpiry"],[107,10,64,28],[107,11,64,29],[107,14,64,32,"get"],[107,17,64,35],[107,18,64,36],[107,19,64,37],[109,10,66,8],[110,10,67,8],[110,14,67,12,"_timestamp"],[110,24,67,22],[110,28,67,27,"now"],[110,31,67,30],[110,34,67,33,"_timestamp"],[110,44,67,43],[110,47,67,46,"cacheExpiry"],[110,58,67,58],[110,60,67,60],[111,12,68,10,"set"],[111,15,68,13],[111,16,68,14],[112,14,69,12,"user"],[112,18,69,16],[112,20,69,18,"userData"],[112,28,69,26],[113,14,70,12,"lastFetchTime"],[113,27,70,25],[113,29,70,27,"_timestamp"],[113,39,70,37],[114,14,71,12,"error"],[114,19,71,17],[114,21,71,19],[115,12,72,10],[115,13,72,11],[115,14,72,12],[116,12,73,10],[116,19,73,17,"user"],[116,23,73,21],[117,10,74,8],[117,11,74,9],[117,17,74,15],[118,12,75,10],[119,12,76,10],[119,16,76,10,"secureDeleteItem"],[119,30,76,26],[119,31,76,26,"secureDeleteItem"],[119,47,76,26],[119,49,76,27,"userCacheKey"],[119,61,76,39],[119,62,76,40],[120,12,77,10,"set"],[120,15,77,13],[120,16,77,14],[121,14,78,12,"user"],[121,18,78,16],[121,20,78,18],[121,24,78,22],[122,14,79,12,"lastFetchTime"],[122,27,79,25],[122,29,79,27],[122,33,79,31],[123,14,80,12,"error"],[123,19,80,17],[123,21,80,19],[124,12,81,10],[124,13,81,11],[124,14,81,12],[125,10,82,8],[126,8,83,6],[127,8,84,6],[127,15,84,13],[127,19,84,17],[128,6,85,4],[128,7,85,5],[128,8,85,6],[128,15,85,13,"error"],[128,20,85,18],[128,22,85,20],[129,8,86,6,"console"],[129,15,86,13],[129,16,86,14,"error"],[129,21,86,19],[129,22,86,20],[129,54,86,52],[129,56,86,54,"error"],[129,61,86,59],[129,62,86,60],[130,8,87,6,"set"],[130,11,87,9],[130,12,87,10],[131,10,87,12,"error"],[131,15,87,17],[131,17,87,19],[132,8,87,57],[132,9,87,58],[132,10,87,59],[133,8,88,6],[133,15,88,13],[133,19,88,17],[134,6,89,4],[135,4,90,2],[135,5,90,3],[136,4,92,2],[137,4,93,2,"clearUser"],[137,13,93,11],[137,15,93,13,"clearUser"],[137,16,93,13],[137,21,93,19],[138,6,94,4],[138,10,94,4,"secureDeleteItem"],[138,24,94,20],[138,25,94,20,"secureDeleteItem"],[138,41,94,20],[138,43,94,21,"userCacheKey"],[138,55,94,33],[138,56,94,34],[139,6,95,4,"set"],[139,9,95,7],[139,10,95,8],[140,8,96,6,"user"],[140,12,96,10],[140,14,96,12],[140,18,96,16],[141,8,97,6,"lastFetchTime"],[141,21,97,19],[141,23,97,21],[141,27,97,25],[142,8,98,6,"error"],[142,13,98,11],[142,15,98,13],[143,6,99,4],[143,7,99,5],[143,8,99,6],[144,4,100,2],[144,5,100,3],[145,4,102,2],[146,4,103,2,"setLoading"],[146,14,103,12],[146,16,103,15,"isLoading"],[146,25,103,24],[146,29,103,29],[147,6,104,4,"set"],[147,9,104,7],[147,10,104,8],[148,8,104,10,"isLoading"],[149,6,104,20],[149,7,104,21],[149,8,104,22],[150,4,105,2],[150,5,105,3],[151,4,107,2],[152,4,108,2,"setError"],[152,12,108,10],[152,14,108,13,"error"],[152,19,108,18],[152,23,108,23],[153,6,109,4,"set"],[153,9,109,7],[153,10,109,8],[154,8,109,10,"error"],[155,6,109,16],[155,7,109,17],[155,8,109,18],[156,4,110,2],[157,2,111,0],[157,3,111,1],[157,4,111,2],[157,5,111,3],[159,2,113,0],[160,0,114,0],[161,0,115,0],[162,2,116,7],[162,8,116,13,"useAuthModal"],[162,20,116,25],[162,23,116,28],[162,27,116,28,"create"],[162,35,116,34],[162,36,116,34,"create"],[162,42,116,34],[162,44,116,36,"set"],[162,47,116,39],[162,52,116,45],[163,4,117,2,"isOpen"],[163,10,117,8],[163,12,117,10],[163,17,117,15],[164,4,118,2,"mode"],[164,8,118,6],[164,10,118,8],[164,18,118,16],[165,4,119,2,"open"],[165,8,119,6],[165,10,119,9,"options"],[165,17,119,16],[165,21,119,21,"set"],[165,24,119,24],[165,25,119,25],[166,6,119,27,"isOpen"],[166,12,119,33],[166,14,119,35],[166,18,119,39],[167,6,119,41,"mode"],[167,10,119,45],[167,12,119,47,"options"],[167,19,119,54],[167,21,119,56,"mode"],[167,25,119,60],[167,29,119,64],[168,4,119,73],[168,5,119,74],[168,6,119,75],[169,4,120,2,"close"],[169,9,120,7],[169,11,120,9,"close"],[169,12,120,9],[169,17,120,15,"set"],[169,20,120,18],[169,21,120,19],[170,6,120,21,"isOpen"],[170,12,120,27],[170,14,120,29],[171,4,120,35],[171,5,120,36],[172,2,121,0],[172,3,121,1],[172,4,121,2],[172,5,121,3],[173,0,121,4],[173,3]],"functionMap":{"names":["<global>","create$argument_0","setAuth","setUser","loadUserFromCache","clearUser","setLoading","setError","open","close"],"mappings":"AAA;mCCS;WCG;GDO;EDC;mCCK;WEQ;GFoB;qBGG;GHiC;aIG;GJO;cKG;GLE;YMG;GNE;EDC;mCCK;QOG,mEP;SQC,4BR;EDC"},"hasCjsExports":false},"type":"js/module"}]}