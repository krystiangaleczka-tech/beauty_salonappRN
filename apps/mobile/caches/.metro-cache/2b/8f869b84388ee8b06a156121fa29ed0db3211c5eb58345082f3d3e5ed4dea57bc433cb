{"dependencies":[{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"../utils/auth/secureStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":60,"index":60}}],"key":"tGTkwDmV6znjLKO6m4T8RtvPbtg=","exportNames":["*"],"imports":1}},{"name":"expo/fetch","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":61},"end":{"line":2,"column":48,"index":109}}],"key":"ug2WTu871fxhwUkT+lg+x8TWZJo=","exportNames":["*"],"imports":1}},{"name":"../config","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":110},"end":{"line":8,"column":19,"index":282}}],"key":"pHqFJJBAh3HI9ZCkK8fFRwPv3x0=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[0], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[1], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _utilsAuthSecureStorage = require(_dependencyMap[2], \"../utils/auth/secureStorage\");\n  var _expoFetch = require(_dependencyMap[3], \"expo/fetch\");\n  var _config = require(_dependencyMap[4], \"../config\");\n  var originalFetch = fetch;\n  var authKey = `${_config.PROJECT_GROUP_ID}-jwt`;\n  var getURLFromArgs = function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    var urlArg = args[0];\n    var url;\n    if (typeof urlArg === 'string') {\n      url = urlArg;\n    } else if (typeof urlArg === 'object' && urlArg !== null) {\n      // @ts-ignore\n      url = urlArg.url;\n    } else {\n      url = null;\n    }\n    return url;\n  };\n  var isFirstPartyURL = url => {\n    return url.startsWith('/') || _config.BASE_URL && url.startsWith(_config.BASE_URL) || _config.PROXY_BASE_URL && url.startsWith(_config.PROXY_BASE_URL);\n  };\n  var isSecondPartyURL = url => {\n    return url.startsWith('/_create/');\n  };\n  var fetchToWeb = /*#__PURE__*/function () {\n    var _fetchWithHeaders = (0, _asyncToGenerator.default)(function* () {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      var input = args[0],\n        init = args[1];\n      var url = getURLFromArgs(input, init);\n      if (!url) {\n        return (0, _expoFetch.fetch)(input, init);\n      }\n      var isExternalFetch = !isFirstPartyURL(url);\n      // we should not add headers to requests that don't go to our own server\n      if (isExternalFetch) {\n        return (0, _expoFetch.fetch)(input, init);\n      }\n      var finalInput = input;\n      var baseURL = isSecondPartyURL(url) && _config.PROXY_BASE_URL ? _config.PROXY_BASE_URL : _config.BASE_URL;\n      if (typeof input === 'string') {\n        if (input.startsWith('/') && baseURL) {\n          finalInput = `${baseURL}${input}`;\n        }\n      } else {\n        // non-string Request objects: fallback to original fetch, avoid mutating\n        // @ts-ignore\n        return originalFetch(input, init);\n      }\n      var initHeaders = init?.headers ?? {};\n      var finalHeaders = new Headers(initHeaders);\n      var headers = {\n        'x-createxyz-project-group-id': _config.PROJECT_GROUP_ID,\n        host: _config.HOST,\n        'x-forwarded-host': _config.HOST,\n        'x-createxyz-host': _config.HOST\n      };\n      for (var _ref of Object.entries(headers)) {\n        var _ref2 = (0, _slicedToArray.default)(_ref, 2);\n        var key = _ref2[0];\n        var value = _ref2[1];\n        if (value) {\n          finalHeaders.set(key, value);\n        }\n      }\n      var auth = yield (0, _utilsAuthSecureStorage.secureGetItem)(authKey).then(auth => {\n        return auth ? JSON.parse(auth) : null;\n      }).catch(() => {\n        return null;\n      });\n      if (auth) {\n        finalHeaders.set('authorization', `Bearer ${auth.jwt}`);\n      }\n      return (0, _expoFetch.fetch)(finalInput, {\n        ...init,\n        headers: finalHeaders\n      });\n    });\n    function fetchWithHeaders() {\n      return _fetchWithHeaders.apply(this, arguments);\n    }\n    return fetchWithHeaders;\n  }();\n  var _default = fetchToWeb;\n});","lineCount":111,"map":[[12,2,101,0,"Object"],[12,8,101,0],[12,9,101,0,"defineProperty"],[12,23,101,0],[12,24,101,0,"exports"],[12,31,101,0],[13,4,101,0,"enumerable"],[13,14,101,0],[14,4,101,0,"get"],[14,7,101,0],[14,18,101,0,"get"],[14,19,101,0],[15,6,101,0],[15,13,101,0,"_default"],[15,21,101,0],[16,4,101,0],[17,2,101,0],[18,2,101,26],[18,6,101,26,"_babelRuntimeHelpersSlicedToArray"],[18,39,101,26],[18,42,101,26,"require"],[18,49,101,26],[18,50,101,26,"_dependencyMap"],[18,64,101,26],[19,2,101,26],[19,6,101,26,"_slicedToArray"],[19,20,101,26],[19,23,101,26,"_interopDefault"],[19,38,101,26],[19,39,101,26,"_babelRuntimeHelpersSlicedToArray"],[19,72,101,26],[20,2,101,26],[20,6,101,26,"_babelRuntimeHelpersAsyncToGenerator"],[20,42,101,26],[20,45,101,26,"require"],[20,52,101,26],[20,53,101,26,"_dependencyMap"],[20,67,101,26],[21,2,101,26],[21,6,101,26,"_asyncToGenerator"],[21,23,101,26],[21,26,101,26,"_interopDefault"],[21,41,101,26],[21,42,101,26,"_babelRuntimeHelpersAsyncToGenerator"],[21,78,101,26],[22,2,1,0],[22,6,1,0,"_utilsAuthSecureStorage"],[22,29,1,0],[22,32,1,0,"require"],[22,39,1,0],[22,40,1,0,"_dependencyMap"],[22,54,1,0],[23,2,2,0],[23,6,2,0,"_expoFetch"],[23,16,2,0],[23,19,2,0,"require"],[23,26,2,0],[23,27,2,0,"_dependencyMap"],[23,41,2,0],[24,2,3,0],[24,6,3,0,"_config"],[24,13,3,0],[24,16,3,0,"require"],[24,23,3,0],[24,24,3,0,"_dependencyMap"],[24,38,3,0],[25,2,10,0],[25,6,10,6,"originalFetch"],[25,19,10,19],[25,22,10,22,"fetch"],[25,27,10,27],[26,2,11,0],[26,6,11,6,"authKey"],[26,13,11,13],[26,16,11,16],[26,19,11,19,"CONFIG_PROJECT_GROUP_ID"],[26,26,11,42],[26,27,11,42,"PROJECT_GROUP_ID"],[26,43,11,42],[26,49,11,48],[27,2,13,0],[27,6,13,6,"getURLFromArgs"],[27,20,13,20],[27,23,13,23],[27,32,13,23,"getURLFromArgs"],[27,33,13,23],[27,35,13,62],[28,4,13,62],[28,13,13,62,"_len"],[28,17,13,62],[28,20,13,62,"arguments"],[28,29,13,62],[28,30,13,62,"length"],[28,36,13,62],[28,38,13,27,"args"],[28,42,13,31],[28,49,13,31,"Array"],[28,54,13,31],[28,55,13,31,"_len"],[28,59,13,31],[28,62,13,31,"_key"],[28,66,13,31],[28,72,13,31,"_key"],[28,76,13,31],[28,79,13,31,"_len"],[28,83,13,31],[28,85,13,31,"_key"],[28,89,13,31],[29,6,13,27,"args"],[29,10,13,31],[29,11,13,31,"_key"],[29,15,13,31],[29,19,13,31,"arguments"],[29,28,13,31],[29,29,13,31,"_key"],[29,33,13,31],[30,4,13,31],[31,4,14,2],[31,8,14,9,"urlArg"],[31,14,14,15],[31,17,14,19,"args"],[31,21,14,23],[32,4,15,2],[32,8,15,6,"url"],[32,11,15,24],[33,4,16,2],[33,8,16,6],[33,15,16,13,"urlArg"],[33,21,16,19],[33,26,16,24],[33,34,16,32],[33,36,16,34],[34,6,17,4,"url"],[34,9,17,7],[34,12,17,10,"urlArg"],[34,18,17,16],[35,4,18,2],[35,5,18,3],[35,11,18,9],[35,15,18,13],[35,22,18,20,"urlArg"],[35,28,18,26],[35,33,18,31],[35,41,18,39],[35,45,18,43,"urlArg"],[35,51,18,49],[35,56,18,54],[35,60,18,58],[35,62,18,60],[36,6,19,4],[37,6,20,4,"url"],[37,9,20,7],[37,12,20,10,"urlArg"],[37,18,20,16],[37,19,20,17,"url"],[37,22,20,20],[38,4,21,2],[38,5,21,3],[38,11,21,9],[39,6,22,4,"url"],[39,9,22,7],[39,12,22,10],[39,16,22,14],[40,4,23,2],[41,4,24,2],[41,11,24,9,"url"],[41,14,24,12],[42,2,25,0],[42,3,25,1],[43,2,27,0],[43,6,27,6,"isFirstPartyURL"],[43,21,27,21],[43,24,27,25,"url"],[43,27,27,36],[43,31,27,41],[44,4,28,2],[44,11,29,4,"url"],[44,14,29,7],[44,15,29,8,"startsWith"],[44,25,29,18],[44,26,29,19],[44,29,29,22],[44,30,29,23],[44,34,30,5,"CONFIG_BASE_URL"],[44,41,30,20],[44,42,30,20,"BASE_URL"],[44,50,30,20],[44,54,30,24,"url"],[44,57,30,27],[44,58,30,28,"startsWith"],[44,68,30,38],[44,69,30,39,"CONFIG_BASE_URL"],[44,76,30,54],[44,77,30,54,"BASE_URL"],[44,85,30,54],[44,86,30,56],[44,90,31,5,"CONFIG_PROXY_BASE_URL"],[44,97,31,26],[44,98,31,26,"PROXY_BASE_URL"],[44,112,31,26],[44,116,31,30,"url"],[44,119,31,33],[44,120,31,34,"startsWith"],[44,130,31,44],[44,131,31,45,"CONFIG_PROXY_BASE_URL"],[44,138,31,66],[44,139,31,66,"PROXY_BASE_URL"],[44,153,31,66],[44,154,31,68],[45,2,33,0],[45,3,33,1],[46,2,35,0],[46,6,35,6,"isSecondPartyURL"],[46,22,35,22],[46,25,35,26,"url"],[46,28,35,37],[46,32,35,42],[47,4,36,2],[47,11,36,9,"url"],[47,14,36,12],[47,15,36,13,"startsWith"],[47,25,36,23],[47,26,36,24],[47,37,36,35],[47,38,36,36],[48,2,37,0],[48,3,37,1],[49,2,40,0],[49,6,40,6,"fetchToWeb"],[49,16,40,16],[50,4,40,16],[50,8,40,16,"_fetchWithHeaders"],[50,25,40,16],[50,32,40,16,"_asyncToGenerator"],[50,49,40,16],[50,50,40,16,"default"],[50,57,40,16],[50,59,40,19],[50,72,40,68],[51,6,40,68],[51,15,40,68,"_len2"],[51,20,40,68],[51,23,40,68,"arguments"],[51,32,40,68],[51,33,40,68,"length"],[51,39,40,68],[51,41,40,54,"args"],[51,45,40,58],[51,52,40,58,"Array"],[51,57,40,58],[51,58,40,58,"_len2"],[51,63,40,58],[51,66,40,58,"_key2"],[51,71,40,58],[51,77,40,58,"_key2"],[51,82,40,58],[51,85,40,58,"_len2"],[51,90,40,58],[51,92,40,58,"_key2"],[51,97,40,58],[52,8,40,54,"args"],[52,12,40,58],[52,13,40,58,"_key2"],[52,18,40,58],[52,22,40,58,"arguments"],[52,31,40,58],[52,32,40,58,"_key2"],[52,37,40,58],[53,6,40,58],[54,6,41,2],[54,10,41,9,"input"],[54,15,41,14],[54,18,41,24,"args"],[54,22,41,28],[55,8,41,16,"init"],[55,12,41,20],[55,15,41,24,"args"],[55,19,41,28],[56,6,42,2],[56,10,42,8,"url"],[56,13,42,11],[56,16,42,14,"getURLFromArgs"],[56,30,42,28],[56,31,42,29,"input"],[56,36,42,34],[56,38,42,43,"init"],[56,42,42,54],[56,43,42,55],[57,6,43,2],[57,10,43,6],[57,11,43,7,"url"],[57,14,43,10],[57,16,43,12],[58,8,44,4],[58,15,44,11],[58,19,44,11,"expoFetch"],[58,29,44,20],[58,30,44,20,"fetch"],[58,35,44,20],[58,37,44,21,"input"],[58,42,44,26],[58,44,44,28,"init"],[58,48,44,32],[58,49,44,33],[59,6,45,2],[60,6,47,2],[60,10,47,8,"isExternalFetch"],[60,25,47,23],[60,28,47,26],[60,29,47,27,"isFirstPartyURL"],[60,44,47,42],[60,45,47,43,"url"],[60,48,47,46],[60,49,47,47],[61,6,48,2],[62,6,49,2],[62,10,49,6,"isExternalFetch"],[62,25,49,21],[62,27,49,23],[63,8,50,4],[63,15,50,11],[63,19,50,11,"expoFetch"],[63,29,50,20],[63,30,50,20,"fetch"],[63,35,50,20],[63,37,50,21,"input"],[63,42,50,26],[63,44,50,28,"init"],[63,48,50,32],[63,49,50,33],[64,6,51,2],[65,6,53,2],[65,10,53,6,"finalInput"],[65,20,53,16],[65,23,53,19,"input"],[65,28,53,24],[66,6,54,2],[66,10,54,8,"baseURL"],[66,17,54,15],[66,20,55,4,"isSecondPartyURL"],[66,36,55,20],[66,37,55,21,"url"],[66,40,55,24],[66,41,55,25],[66,45,55,29,"CONFIG_PROXY_BASE_URL"],[66,52,55,50],[66,53,55,50,"PROXY_BASE_URL"],[66,67,55,50],[66,70,55,53,"CONFIG_PROXY_BASE_URL"],[66,77,55,74],[66,78,55,74,"PROXY_BASE_URL"],[66,92,55,74],[66,95,55,77,"CONFIG_BASE_URL"],[66,102,55,92],[66,103,55,92,"BASE_URL"],[66,111,55,92],[67,6,57,2],[67,10,57,6],[67,17,57,13,"input"],[67,22,57,18],[67,27,57,23],[67,35,57,31],[67,37,57,33],[68,8,58,4],[68,12,58,8,"input"],[68,17,58,13],[68,18,58,14,"startsWith"],[68,28,58,24],[68,29,58,25],[68,32,58,28],[68,33,58,29],[68,37,58,33,"baseURL"],[68,44,58,40],[68,46,58,42],[69,10,59,6,"finalInput"],[69,20,59,16],[69,23,59,19],[69,26,59,22,"baseURL"],[69,33,59,29],[69,36,59,32,"input"],[69,41,59,37],[69,43,59,39],[70,8,60,4],[71,6,61,2],[71,7,61,3],[71,13,61,9],[72,8,62,4],[73,8,63,4],[74,8,64,4],[74,15,64,11,"originalFetch"],[74,28,64,24],[74,29,64,25,"input"],[74,34,64,30],[74,36,64,32,"init"],[74,40,64,36],[74,41,64,37],[75,6,65,2],[76,6,67,2],[76,10,67,8,"initHeaders"],[76,21,67,19],[76,24,67,22,"init"],[76,28,67,26],[76,30,67,28,"headers"],[76,37,67,35],[76,41,67,39],[76,42,67,40],[76,43,67,41],[77,6,68,2],[77,10,68,8,"finalHeaders"],[77,22,68,20],[77,25,68,23],[77,29,68,27,"Headers"],[77,36,68,34],[77,37,68,35,"initHeaders"],[77,48,68,53],[77,49,68,54],[78,6,70,2],[78,10,70,8,"headers"],[78,17,70,51],[78,20,70,54],[79,8,71,4],[79,38,71,34],[79,40,71,36,"CONFIG_PROJECT_GROUP_ID"],[79,47,71,59],[79,48,71,59,"PROJECT_GROUP_ID"],[79,64,71,59],[80,8,72,4,"host"],[80,12,72,8],[80,14,72,10,"CONFIG_HOST"],[80,21,72,21],[80,22,72,21,"HOST"],[80,26,72,21],[81,8,73,4],[81,26,73,22],[81,28,73,24,"CONFIG_HOST"],[81,35,73,35],[81,36,73,35,"HOST"],[81,40,73,35],[82,8,74,4],[82,26,74,22],[82,28,74,24,"CONFIG_HOST"],[82,35,74,35],[82,36,74,35,"HOST"],[83,6,75,2],[83,7,75,3],[84,6,77,2],[84,15,77,2,"_ref"],[84,19,77,2],[84,23,77,29,"Object"],[84,29,77,35],[84,30,77,36,"entries"],[84,37,77,43],[84,38,77,44,"headers"],[84,45,77,51],[84,46,77,52],[84,48,77,54],[85,8,77,54],[85,12,77,54,"_ref2"],[85,17,77,54],[85,24,77,54,"_slicedToArray"],[85,38,77,54],[85,39,77,54,"default"],[85,46,77,54],[85,48,77,54,"_ref"],[85,52,77,54],[86,8,77,54],[86,12,77,14,"key"],[86,15,77,17],[86,18,77,17,"_ref2"],[86,23,77,17],[87,8,77,17],[87,12,77,19,"value"],[87,17,77,24],[87,20,77,24,"_ref2"],[87,25,77,24],[88,8,78,4],[88,12,78,8,"value"],[88,17,78,13],[88,19,78,15],[89,10,79,6,"finalHeaders"],[89,22,79,18],[89,23,79,19,"set"],[89,26,79,22],[89,27,79,23,"key"],[89,30,79,26],[89,32,79,28,"value"],[89,37,79,33],[89,38,79,34],[90,8,80,4],[91,6,81,2],[92,6,83,2],[92,10,83,8,"auth"],[92,14,83,12],[92,23,83,21],[92,27,83,21,"secureGetItem"],[92,50,83,34],[92,51,83,34,"secureGetItem"],[92,64,83,34],[92,66,83,35,"authKey"],[92,73,83,42],[92,74,83,43],[92,75,84,5,"then"],[92,79,84,9],[92,80,84,11,"auth"],[92,84,84,15],[92,88,84,20],[93,8,85,6],[93,15,85,13,"auth"],[93,19,85,17],[93,22,85,20,"JSON"],[93,26,85,24],[93,27,85,25,"parse"],[93,32,85,30],[93,33,85,31,"auth"],[93,37,85,35],[93,38,85,36],[93,41,85,39],[93,45,85,43],[94,6,86,4],[94,7,86,5],[94,8,86,6],[94,9,87,5,"catch"],[94,14,87,10],[94,15,87,11],[94,21,87,17],[95,8,88,6],[95,15,88,13],[95,19,88,17],[96,6,89,4],[96,7,89,5],[96,8,89,6],[97,6,91,2],[97,10,91,6,"auth"],[97,14,91,10],[97,16,91,12],[98,8,92,4,"finalHeaders"],[98,20,92,16],[98,21,92,17,"set"],[98,24,92,20],[98,25,92,21],[98,40,92,36],[98,42,92,38],[98,52,92,48,"auth"],[98,56,92,52],[98,57,92,53,"jwt"],[98,60,92,56],[98,62,92,58],[98,63,92,59],[99,6,93,2],[100,6,95,2],[100,13,95,9],[100,17,95,9,"expoFetch"],[100,27,95,18],[100,28,95,18,"fetch"],[100,33,95,18],[100,35,95,19,"finalInput"],[100,45,95,29],[100,47,95,38],[101,8,96,4],[101,11,96,7,"init"],[101,15,96,11],[102,8,97,4,"headers"],[102,15,97,11],[102,17,97,13,"finalHeaders"],[103,6,98,2],[103,7,98,3],[103,8,98,4],[104,4,99,0],[104,5,99,1],[105,4,99,1],[105,13,40,34,"fetchWithHeaders"],[105,29,40,50,"fetchWithHeaders"],[105,30,40,50],[106,6,40,50],[106,13,40,50,"_fetchWithHeaders"],[106,30,40,50],[106,31,40,50,"apply"],[106,36,40,50],[106,43,40,50,"arguments"],[106,52,40,50],[107,4,40,50],[108,4,40,50],[108,11,40,34,"fetchWithHeaders"],[108,27,40,50],[109,2,40,50],[109,5,99,1],[110,2,101,0],[110,6,101,0,"_default"],[110,14,101,0],[110,17,101,15,"fetchToWeb"],[110,27,101,25],[111,0,101,26],[111,3]],"functionMap":{"names":["<global>","getURLFromArgs","isFirstPartyURL","isSecondPartyURL","fetchWithHeaders","secureGetItem.then$argument_0","secureGetItem.then._catch$argument_0"],"mappings":"AAA;uBCY;CDY;wBEE;CFM;yBGE;CHE;mBIG;UC4C;KDE;WEC;KFE;CJU"},"hasCjsExports":false},"type":"js/module"}]}