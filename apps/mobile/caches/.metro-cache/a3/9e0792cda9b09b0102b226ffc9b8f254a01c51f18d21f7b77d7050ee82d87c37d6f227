{"dependencies":[{"name":"tslib","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":12,"index":91},"end":{"line":5,"column":28,"index":107}}],"key":"vm88vOsSPZItrLOmMEyUuGkd1y4=","exportNames":["*"],"imports":1}},{"name":"../resize/index.cjs.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":12,"index":121},"end":{"line":6,"column":45,"index":154}}],"key":"jNp3FlTGeKXjrDulAyNnMHCzigc=","exportNames":["*"],"imports":1}},{"name":"./info.cjs.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":11,"index":167},"end":{"line":7,"column":35,"index":191}}],"key":"Aug+LZcq6+qORyl0Sq+lxcSs2mE=","exportNames":["*"],"imports":1}},{"name":"./on-scroll-handler.cjs.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":22,"index":215},"end":{"line":8,"column":59,"index":252}}],"key":"91DqRn/hQanaMIyeXOzv2+Iu7rE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  var tslib = require(_dependencyMap[0], \"tslib\");\n  var index = require(_dependencyMap[1], \"../resize/index.cjs.js\");\n  var info = require(_dependencyMap[2], \"./info.cjs.js\");\n  var onScrollHandler = require(_dependencyMap[3], \"./on-scroll-handler.cjs.js\");\n  var scrollListeners = new WeakMap();\n  var resizeListeners = new WeakMap();\n  var onScrollHandlers = new WeakMap();\n  var getEventTarget = element => element === document.documentElement ? window : element;\n  function scroll(onScroll) {\n    var _a = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var _a$container = _a.container,\n      container = _a$container === void 0 ? document.documentElement : _a$container,\n      options = tslib.__rest(_a, [\"container\"]);\n    var containerHandlers = onScrollHandlers.get(container);\n    /**\n     * Get the onScroll handlers for this container.\n     * If one isn't found, create a new one.\n     */\n    if (!containerHandlers) {\n      containerHandlers = new Set();\n      onScrollHandlers.set(container, containerHandlers);\n    }\n    /**\n     * Create a new onScroll handler for the provided callback.\n     */\n    var info$1 = info.createScrollInfo();\n    var containerHandler = onScrollHandler.createOnScrollHandler(container, onScroll, info$1, options);\n    containerHandlers.add(containerHandler);\n    /**\n     * Check if there's a scroll event listener for this container.\n     * If not, create one.\n     */\n    if (!scrollListeners.has(container)) {\n      var _listener = () => {\n        var time = performance.now();\n        for (var handler of containerHandlers) handler.measure();\n        for (var _handler of containerHandlers) _handler.update(time);\n        for (var _handler2 of containerHandlers) _handler2.notify();\n      };\n      scrollListeners.set(container, _listener);\n      var target = getEventTarget(container);\n      window.addEventListener(\"resize\", _listener, {\n        passive: true\n      });\n      if (container !== document.documentElement) {\n        resizeListeners.set(container, index.resize(container, _listener));\n      }\n      target.addEventListener(\"scroll\", _listener, {\n        passive: true\n      });\n    }\n    var listener = scrollListeners.get(container);\n    var onLoadProcesss = requestAnimationFrame(listener);\n    return () => {\n      var _a;\n      if (typeof onScroll !== \"function\") onScroll.stop();\n      cancelAnimationFrame(onLoadProcesss);\n      /**\n       * Check if we even have any handlers for this container.\n       */\n      var containerHandlers = onScrollHandlers.get(container);\n      if (!containerHandlers) return;\n      containerHandlers.delete(containerHandler);\n      if (containerHandlers.size) return;\n      /**\n       * If no more handlers, remove the scroll listener too.\n       */\n      var listener = scrollListeners.get(container);\n      scrollListeners.delete(container);\n      if (listener) {\n        getEventTarget(container).removeEventListener(\"scroll\", listener);\n        (_a = resizeListeners.get(container)) === null || _a === void 0 ? void 0 : _a();\n        window.removeEventListener(\"resize\", listener);\n      }\n    };\n  }\n  exports.scroll = scroll;\n});","lineCount":84,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0,"Object"],[4,8,3,6],[4,9,3,7,"defineProperty"],[4,23,3,21],[4,24,3,22,"exports"],[4,31,3,29],[4,33,3,31],[4,45,3,43],[4,47,3,45],[5,4,3,47,"value"],[5,9,3,52],[5,11,3,54],[6,2,3,59],[6,3,3,60],[6,4,3,61],[7,2,5,0],[7,6,5,4,"tslib"],[7,11,5,9],[7,14,5,12,"require"],[7,21,5,19],[7,22,5,19,"_dependencyMap"],[7,36,5,19],[7,48,5,27],[7,49,5,28],[8,2,6,0],[8,6,6,4,"index"],[8,11,6,9],[8,14,6,12,"require"],[8,21,6,19],[8,22,6,19,"_dependencyMap"],[8,36,6,19],[8,65,6,44],[8,66,6,45],[9,2,7,0],[9,6,7,4,"info"],[9,10,7,8],[9,13,7,11,"require"],[9,20,7,18],[9,21,7,18,"_dependencyMap"],[9,35,7,18],[9,55,7,34],[9,56,7,35],[10,2,8,0],[10,6,8,4,"onScrollHandler"],[10,21,8,19],[10,24,8,22,"require"],[10,31,8,29],[10,32,8,29,"_dependencyMap"],[10,46,8,29],[10,79,8,58],[10,80,8,59],[11,2,10,0],[11,6,10,6,"scrollListeners"],[11,21,10,21],[11,24,10,24],[11,28,10,28,"WeakMap"],[11,35,10,35],[11,36,10,36],[11,37,10,37],[12,2,11,0],[12,6,11,6,"resizeListeners"],[12,21,11,21],[12,24,11,24],[12,28,11,28,"WeakMap"],[12,35,11,35],[12,36,11,36],[12,37,11,37],[13,2,12,0],[13,6,12,6,"onScrollHandlers"],[13,22,12,22],[13,25,12,25],[13,29,12,29,"WeakMap"],[13,36,12,36],[13,37,12,37],[13,38,12,38],[14,2,13,0],[14,6,13,6,"getEventTarget"],[14,20,13,20],[14,23,13,24,"element"],[14,30,13,31],[14,34,13,36,"element"],[14,41,13,43],[14,46,13,48,"document"],[14,54,13,56],[14,55,13,57,"documentElement"],[14,70,13,72],[14,73,13,75,"window"],[14,79,13,81],[14,82,13,84,"element"],[14,89,13,91],[15,2,14,0],[15,11,14,9,"scroll"],[15,17,14,15,"scroll"],[15,18,14,16,"onScroll"],[15,26,14,24],[15,28,14,35],[16,4,14,35],[16,8,14,26,"_a"],[16,10,14,28],[16,13,14,28,"arguments"],[16,22,14,28],[16,23,14,28,"length"],[16,29,14,28],[16,37,14,28,"arguments"],[16,46,14,28],[16,54,14,28,"undefined"],[16,63,14,28],[16,66,14,28,"arguments"],[16,75,14,28],[16,81,14,31],[16,82,14,32],[16,83,14,33],[17,4,15,4],[17,8,15,4,"_a$container"],[17,20,15,4],[17,23,15,51,"_a"],[17,25,15,53],[17,26,15,10,"container"],[17,35,15,19],[18,6,15,10,"container"],[18,15,15,19],[18,18,15,19,"_a$container"],[18,30,15,19],[18,44,15,22,"document"],[18,52,15,30],[18,53,15,31,"documentElement"],[18,68,15,46],[18,71,15,46,"_a$container"],[18,83,15,46],[19,6,15,55,"options"],[19,13,15,62],[19,16,15,65,"tslib"],[19,21,15,70],[19,22,15,71,"__rest"],[19,28,15,77],[19,29,15,78,"_a"],[19,31,15,80],[19,33,15,82],[19,34,15,83],[19,45,15,94],[19,46,15,95],[19,47,15,96],[20,4,16,4],[20,8,16,8,"containerHandlers"],[20,25,16,25],[20,28,16,28,"onScrollHandlers"],[20,44,16,44],[20,45,16,45,"get"],[20,48,16,48],[20,49,16,49,"container"],[20,58,16,58],[20,59,16,59],[21,4,17,4],[22,0,18,0],[23,0,19,0],[24,0,20,0],[25,4,21,4],[25,8,21,8],[25,9,21,9,"containerHandlers"],[25,26,21,26],[25,28,21,28],[26,6,22,8,"containerHandlers"],[26,23,22,25],[26,26,22,28],[26,30,22,32,"Set"],[26,33,22,35],[26,34,22,36],[26,35,22,37],[27,6,23,8,"onScrollHandlers"],[27,22,23,24],[27,23,23,25,"set"],[27,26,23,28],[27,27,23,29,"container"],[27,36,23,38],[27,38,23,40,"containerHandlers"],[27,55,23,57],[27,56,23,58],[28,4,24,4],[29,4,25,4],[30,0,26,0],[31,0,27,0],[32,4,28,4],[32,8,28,10,"info$1"],[32,14,28,16],[32,17,28,19,"info"],[32,21,28,23],[32,22,28,24,"createScrollInfo"],[32,38,28,40],[32,39,28,41],[32,40,28,42],[33,4,29,4],[33,8,29,10,"containerHandler"],[33,24,29,26],[33,27,29,29,"onScrollHandler"],[33,42,29,44],[33,43,29,45,"createOnScrollHandler"],[33,64,29,66],[33,65,29,67,"container"],[33,74,29,76],[33,76,29,78,"onScroll"],[33,84,29,86],[33,86,29,88,"info$1"],[33,92,29,94],[33,94,29,96,"options"],[33,101,29,103],[33,102,29,104],[34,4,30,4,"containerHandlers"],[34,21,30,21],[34,22,30,22,"add"],[34,25,30,25],[34,26,30,26,"containerHandler"],[34,42,30,42],[34,43,30,43],[35,4,31,4],[36,0,32,0],[37,0,33,0],[38,0,34,0],[39,4,35,4],[39,8,35,8],[39,9,35,9,"scrollListeners"],[39,24,35,24],[39,25,35,25,"has"],[39,28,35,28],[39,29,35,29,"container"],[39,38,35,38],[39,39,35,39],[39,41,35,41],[40,6,36,8],[40,10,36,14,"listener"],[40,19,36,22],[40,22,36,25,"listener"],[40,23,36,25],[40,28,36,31],[41,8,37,12],[41,12,37,18,"time"],[41,16,37,22],[41,19,37,25,"performance"],[41,30,37,36],[41,31,37,37,"now"],[41,34,37,40],[41,35,37,41],[41,36,37,42],[42,8,38,12],[42,13,38,17],[42,17,38,23,"handler"],[42,24,38,30],[42,28,38,34,"containerHandlers"],[42,45,38,51],[42,47,39,16,"handler"],[42,54,39,23],[42,55,39,24,"measure"],[42,62,39,31],[42,63,39,32],[42,64,39,33],[43,8,40,12],[43,13,40,17],[43,17,40,23,"handler"],[43,25,40,30],[43,29,40,34,"containerHandlers"],[43,46,40,51],[43,48,41,16,"handler"],[43,56,41,23],[43,57,41,24,"update"],[43,63,41,30],[43,64,41,31,"time"],[43,68,41,35],[43,69,41,36],[44,8,42,12],[44,13,42,17],[44,17,42,23,"handler"],[44,26,42,30],[44,30,42,34,"containerHandlers"],[44,47,42,51],[44,49,43,16,"handler"],[44,58,43,23],[44,59,43,24,"notify"],[44,65,43,30],[44,66,43,31],[44,67,43,32],[45,6,44,8],[45,7,44,9],[46,6,45,8,"scrollListeners"],[46,21,45,23],[46,22,45,24,"set"],[46,25,45,27],[46,26,45,28,"container"],[46,35,45,37],[46,37,45,39,"listener"],[46,46,45,47],[46,47,45,48],[47,6,46,8],[47,10,46,14,"target"],[47,16,46,20],[47,19,46,23,"getEventTarget"],[47,33,46,37],[47,34,46,38,"container"],[47,43,46,47],[47,44,46,48],[48,6,47,8,"window"],[48,12,47,14],[48,13,47,15,"addEventListener"],[48,29,47,31],[48,30,47,32],[48,38,47,40],[48,40,47,42,"listener"],[48,49,47,50],[48,51,47,52],[49,8,47,54,"passive"],[49,15,47,61],[49,17,47,63],[50,6,47,68],[50,7,47,69],[50,8,47,70],[51,6,48,8],[51,10,48,12,"container"],[51,19,48,21],[51,24,48,26,"document"],[51,32,48,34],[51,33,48,35,"documentElement"],[51,48,48,50],[51,50,48,52],[52,8,49,12,"resizeListeners"],[52,23,49,27],[52,24,49,28,"set"],[52,27,49,31],[52,28,49,32,"container"],[52,37,49,41],[52,39,49,43,"index"],[52,44,49,48],[52,45,49,49,"resize"],[52,51,49,55],[52,52,49,56,"container"],[52,61,49,65],[52,63,49,67,"listener"],[52,72,49,75],[52,73,49,76],[52,74,49,77],[53,6,50,8],[54,6,51,8,"target"],[54,12,51,14],[54,13,51,15,"addEventListener"],[54,29,51,31],[54,30,51,32],[54,38,51,40],[54,40,51,42,"listener"],[54,49,51,50],[54,51,51,52],[55,8,51,54,"passive"],[55,15,51,61],[55,17,51,63],[56,6,51,68],[56,7,51,69],[56,8,51,70],[57,4,52,4],[58,4,53,4],[58,8,53,10,"listener"],[58,16,53,18],[58,19,53,21,"scrollListeners"],[58,34,53,36],[58,35,53,37,"get"],[58,38,53,40],[58,39,53,41,"container"],[58,48,53,50],[58,49,53,51],[59,4,54,4],[59,8,54,10,"onLoadProcesss"],[59,22,54,24],[59,25,54,27,"requestAnimationFrame"],[59,46,54,48],[59,47,54,49,"listener"],[59,55,54,57],[59,56,54,58],[60,4,55,4],[60,11,55,11],[60,17,55,17],[61,6,56,8],[61,10,56,12,"_a"],[61,12,56,14],[62,6,57,8],[62,10,57,12],[62,17,57,19,"onScroll"],[62,25,57,27],[62,30,57,32],[62,40,57,42],[62,42,58,12,"onScroll"],[62,50,58,20],[62,51,58,21,"stop"],[62,55,58,25],[62,56,58,26],[62,57,58,27],[63,6,59,8,"cancelAnimationFrame"],[63,26,59,28],[63,27,59,29,"onLoadProcesss"],[63,41,59,43],[63,42,59,44],[64,6,60,8],[65,0,61,0],[66,0,62,0],[67,6,63,8],[67,10,63,14,"containerHandlers"],[67,27,63,31],[67,30,63,34,"onScrollHandlers"],[67,46,63,50],[67,47,63,51,"get"],[67,50,63,54],[67,51,63,55,"container"],[67,60,63,64],[67,61,63,65],[68,6,64,8],[68,10,64,12],[68,11,64,13,"containerHandlers"],[68,28,64,30],[68,30,65,12],[69,6,66,8,"containerHandlers"],[69,23,66,25],[69,24,66,26,"delete"],[69,30,66,32],[69,31,66,33,"containerHandler"],[69,47,66,49],[69,48,66,50],[70,6,67,8],[70,10,67,12,"containerHandlers"],[70,27,67,29],[70,28,67,30,"size"],[70,32,67,34],[70,34,68,12],[71,6,69,8],[72,0,70,0],[73,0,71,0],[74,6,72,8],[74,10,72,14,"listener"],[74,18,72,22],[74,21,72,25,"scrollListeners"],[74,36,72,40],[74,37,72,41,"get"],[74,40,72,44],[74,41,72,45,"container"],[74,50,72,54],[74,51,72,55],[75,6,73,8,"scrollListeners"],[75,21,73,23],[75,22,73,24,"delete"],[75,28,73,30],[75,29,73,31,"container"],[75,38,73,40],[75,39,73,41],[76,6,74,8],[76,10,74,12,"listener"],[76,18,74,20],[76,20,74,22],[77,8,75,12,"getEventTarget"],[77,22,75,26],[77,23,75,27,"container"],[77,32,75,36],[77,33,75,37],[77,34,75,38,"removeEventListener"],[77,53,75,57],[77,54,75,58],[77,62,75,66],[77,64,75,68,"listener"],[77,72,75,76],[77,73,75,77],[78,8,76,12],[78,9,76,13,"_a"],[78,11,76,15],[78,14,76,18,"resizeListeners"],[78,29,76,33],[78,30,76,34,"get"],[78,33,76,37],[78,34,76,38,"container"],[78,43,76,47],[78,44,76,48],[78,50,76,54],[78,54,76,58],[78,58,76,62,"_a"],[78,60,76,64],[78,65,76,69],[78,70,76,74],[78,71,76,75],[78,74,76,78],[78,79,76,83],[78,80,76,84],[78,83,76,87,"_a"],[78,85,76,89],[78,86,76,90],[78,87,76,91],[79,8,77,12,"window"],[79,14,77,18],[79,15,77,19,"removeEventListener"],[79,34,77,38],[79,35,77,39],[79,43,77,47],[79,45,77,49,"listener"],[79,53,77,57],[79,54,77,58],[80,6,78,8],[81,4,79,4],[81,5,79,5],[82,2,80,0],[83,2,82,0,"exports"],[83,9,82,7],[83,10,82,8,"scroll"],[83,16,82,14],[83,19,82,17,"scroll"],[83,25,82,23],[84,0,82,24],[84,3]],"functionMap":{"names":["<global>","getEventTarget","scroll","listener","<anonymous>"],"mappings":"AAA;uBCY,oED;AEC;yBCsB;SDQ;WEW;KFwB;CFC"},"hasCjsExports":true},"type":"js/module"}]}