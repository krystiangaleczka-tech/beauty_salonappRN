{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"createRenderStep\", {\n    enumerable: true,\n    get: function () {\n      return createRenderStep;\n    }\n  });\n  function createRenderStep(runNextFrame) {\n    let toRun = [];\n    let toRunNextFrame = [];\n    let numToRun = 0;\n    let isProcessing = false;\n    let flushNextFrame = false;\n    const toKeepAlive = new WeakSet();\n    const step = {\n      schedule: (callback, keepAlive = false, immediate = false) => {\n        const addToCurrentFrame = immediate && isProcessing;\n        const buffer = addToCurrentFrame ? toRun : toRunNextFrame;\n        if (keepAlive) toKeepAlive.add(callback);\n        if (buffer.indexOf(callback) === -1) {\n          buffer.push(callback);\n          if (addToCurrentFrame && isProcessing) numToRun = toRun.length;\n        }\n        return callback;\n      },\n      cancel: callback => {\n        const index = toRunNextFrame.indexOf(callback);\n        if (index !== -1) toRunNextFrame.splice(index, 1);\n        toKeepAlive.delete(callback);\n      },\n      process: frameData => {\n        if (isProcessing) {\n          flushNextFrame = true;\n          return;\n        }\n        isProcessing = true;\n        [toRun, toRunNextFrame] = [toRunNextFrame, toRun];\n        toRunNextFrame.length = 0;\n        numToRun = toRun.length;\n        if (numToRun) {\n          for (let i = 0; i < numToRun; i++) {\n            const callback = toRun[i];\n            callback(frameData);\n            if (toKeepAlive.has(callback)) {\n              step.schedule(callback);\n              runNextFrame();\n            }\n          }\n        }\n        isProcessing = false;\n        if (flushNextFrame) {\n          flushNextFrame = false;\n          step.process(frameData);\n        }\n      }\n    };\n    return step;\n  }\n});","lineCount":64,"map":[[7,2,56,0,"Object"],[7,8,56,0],[7,9,56,0,"defineProperty"],[7,23,56,0],[7,24,56,0,"exports"],[7,31,56,0],[8,4,56,0,"enumerable"],[8,14,56,0],[9,4,56,0,"get"],[9,7,56,0],[9,18,56,0,"get"],[9,19,56,0],[10,6,56,0],[10,13,56,9,"createRenderStep"],[10,29,56,25],[11,4,56,25],[12,2,56,25],[13,2,1,0],[13,11,1,9,"createRenderStep"],[13,27,1,25,"createRenderStep"],[13,28,1,26,"runNextFrame"],[13,40,1,38],[13,42,1,40],[14,4,2,4],[14,8,2,8,"toRun"],[14,13,2,13],[14,16,2,16],[14,18,2,18],[15,4,3,4],[15,8,3,8,"toRunNextFrame"],[15,22,3,22],[15,25,3,25],[15,27,3,27],[16,4,4,4],[16,8,4,8,"numToRun"],[16,16,4,16],[16,19,4,19],[16,20,4,20],[17,4,5,4],[17,8,5,8,"isProcessing"],[17,20,5,20],[17,23,5,23],[17,28,5,28],[18,4,6,4],[18,8,6,8,"flushNextFrame"],[18,22,6,22],[18,25,6,25],[18,30,6,30],[19,4,7,4],[19,10,7,10,"toKeepAlive"],[19,21,7,21],[19,24,7,24],[19,28,7,28,"WeakSet"],[19,35,7,35],[19,36,7,36],[19,37,7,37],[20,4,8,4],[20,10,8,10,"step"],[20,14,8,14],[20,17,8,17],[21,6,9,8,"schedule"],[21,14,9,16],[21,16,9,18,"schedule"],[21,17,9,19,"callback"],[21,25,9,27],[21,27,9,29,"keepAlive"],[21,36,9,38],[21,39,9,41],[21,44,9,46],[21,46,9,48,"immediate"],[21,55,9,57],[21,58,9,60],[21,63,9,65],[21,68,9,70],[22,8,10,12],[22,14,10,18,"addToCurrentFrame"],[22,31,10,35],[22,34,10,38,"immediate"],[22,43,10,47],[22,47,10,51,"isProcessing"],[22,59,10,63],[23,8,11,12],[23,14,11,18,"buffer"],[23,20,11,24],[23,23,11,27,"addToCurrentFrame"],[23,40,11,44],[23,43,11,47,"toRun"],[23,48,11,52],[23,51,11,55,"toRunNextFrame"],[23,65,11,69],[24,8,12,12],[24,12,12,16,"keepAlive"],[24,21,12,25],[24,23,13,16,"toKeepAlive"],[24,34,13,27],[24,35,13,28,"add"],[24,38,13,31],[24,39,13,32,"callback"],[24,47,13,40],[24,48,13,41],[25,8,14,12],[25,12,14,16,"buffer"],[25,18,14,22],[25,19,14,23,"indexOf"],[25,26,14,30],[25,27,14,31,"callback"],[25,35,14,39],[25,36,14,40],[25,41,14,45],[25,42,14,46],[25,43,14,47],[25,45,14,49],[26,10,15,16,"buffer"],[26,16,15,22],[26,17,15,23,"push"],[26,21,15,27],[26,22,15,28,"callback"],[26,30,15,36],[26,31,15,37],[27,10,16,16],[27,14,16,20,"addToCurrentFrame"],[27,31,16,37],[27,35,16,41,"isProcessing"],[27,47,16,53],[27,49,17,20,"numToRun"],[27,57,17,28],[27,60,17,31,"toRun"],[27,65,17,36],[27,66,17,37,"length"],[27,72,17,43],[28,8,18,12],[29,8,19,12],[29,15,19,19,"callback"],[29,23,19,27],[30,6,20,8],[30,7,20,9],[31,6,21,8,"cancel"],[31,12,21,14],[31,14,21,17,"callback"],[31,22,21,25],[31,26,21,30],[32,8,22,12],[32,14,22,18,"index"],[32,19,22,23],[32,22,22,26,"toRunNextFrame"],[32,36,22,40],[32,37,22,41,"indexOf"],[32,44,22,48],[32,45,22,49,"callback"],[32,53,22,57],[32,54,22,58],[33,8,23,12],[33,12,23,16,"index"],[33,17,23,21],[33,22,23,26],[33,23,23,27],[33,24,23,28],[33,26,24,16,"toRunNextFrame"],[33,40,24,30],[33,41,24,31,"splice"],[33,47,24,37],[33,48,24,38,"index"],[33,53,24,43],[33,55,24,45],[33,56,24,46],[33,57,24,47],[34,8,25,12,"toKeepAlive"],[34,19,25,23],[34,20,25,24,"delete"],[34,26,25,30],[34,27,25,31,"callback"],[34,35,25,39],[34,36,25,40],[35,6,26,8],[35,7,26,9],[36,6,27,8,"process"],[36,13,27,15],[36,15,27,18,"frameData"],[36,24,27,27],[36,28,27,32],[37,8,28,12],[37,12,28,16,"isProcessing"],[37,24,28,28],[37,26,28,30],[38,10,29,16,"flushNextFrame"],[38,24,29,30],[38,27,29,33],[38,31,29,37],[39,10,30,16],[40,8,31,12],[41,8,32,12,"isProcessing"],[41,20,32,24],[41,23,32,27],[41,27,32,31],[42,8,33,12],[42,9,33,13,"toRun"],[42,14,33,18],[42,16,33,20,"toRunNextFrame"],[42,30,33,34],[42,31,33,35],[42,34,33,38],[42,35,33,39,"toRunNextFrame"],[42,49,33,53],[42,51,33,55,"toRun"],[42,56,33,60],[42,57,33,61],[43,8,34,12,"toRunNextFrame"],[43,22,34,26],[43,23,34,27,"length"],[43,29,34,33],[43,32,34,36],[43,33,34,37],[44,8,35,12,"numToRun"],[44,16,35,20],[44,19,35,23,"toRun"],[44,24,35,28],[44,25,35,29,"length"],[44,31,35,35],[45,8,36,12],[45,12,36,16,"numToRun"],[45,20,36,24],[45,22,36,26],[46,10,37,16],[46,15,37,21],[46,19,37,25,"i"],[46,20,37,26],[46,23,37,29],[46,24,37,30],[46,26,37,32,"i"],[46,27,37,33],[46,30,37,36,"numToRun"],[46,38,37,44],[46,40,37,46,"i"],[46,41,37,47],[46,43,37,49],[46,45,37,51],[47,12,38,20],[47,18,38,26,"callback"],[47,26,38,34],[47,29,38,37,"toRun"],[47,34,38,42],[47,35,38,43,"i"],[47,36,38,44],[47,37,38,45],[48,12,39,20,"callback"],[48,20,39,28],[48,21,39,29,"frameData"],[48,30,39,38],[48,31,39,39],[49,12,40,20],[49,16,40,24,"toKeepAlive"],[49,27,40,35],[49,28,40,36,"has"],[49,31,40,39],[49,32,40,40,"callback"],[49,40,40,48],[49,41,40,49],[49,43,40,51],[50,14,41,24,"step"],[50,18,41,28],[50,19,41,29,"schedule"],[50,27,41,37],[50,28,41,38,"callback"],[50,36,41,46],[50,37,41,47],[51,14,42,24,"runNextFrame"],[51,26,42,36],[51,27,42,37],[51,28,42,38],[52,12,43,20],[53,10,44,16],[54,8,45,12],[55,8,46,12,"isProcessing"],[55,20,46,24],[55,23,46,27],[55,28,46,32],[56,8,47,12],[56,12,47,16,"flushNextFrame"],[56,26,47,30],[56,28,47,32],[57,10,48,16,"flushNextFrame"],[57,24,48,30],[57,27,48,33],[57,32,48,38],[58,10,49,16,"step"],[58,14,49,20],[58,15,49,21,"process"],[58,22,49,28],[58,23,49,29,"frameData"],[58,32,49,38],[58,33,49,39],[59,8,50,12],[60,6,51,8],[61,4,52,4],[61,5,52,5],[62,4,53,4],[62,11,53,11,"step"],[62,15,53,15],[63,2,54,0],[64,0,54,1],[64,3]],"functionMap":{"names":["createRenderStep","step.schedule","step.cancel","step.process","<global>"],"mappings":"AAA;kBCQ;SDW;gBEC;SFK;iBGC;SHwB;CIG"},"hasCjsExports":false},"type":"js/module"}]}