{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"createRenderStep\", {\n    enumerable: true,\n    get: function () {\n      return createRenderStep;\n    }\n  });\n  function createRenderStep(runNextFrame) {\n    var toRun = [];\n    var toRunNextFrame = [];\n    var numToRun = 0;\n    var isProcessing = false;\n    var flushNextFrame = false;\n    var toKeepAlive = new WeakSet();\n    var step = {\n      schedule: function (callback) {\n        var keepAlive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        var immediate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n        var addToCurrentFrame = immediate && isProcessing;\n        var buffer = addToCurrentFrame ? toRun : toRunNextFrame;\n        if (keepAlive) toKeepAlive.add(callback);\n        if (buffer.indexOf(callback) === -1) {\n          buffer.push(callback);\n          if (addToCurrentFrame && isProcessing) numToRun = toRun.length;\n        }\n        return callback;\n      },\n      cancel: callback => {\n        var index = toRunNextFrame.indexOf(callback);\n        if (index !== -1) toRunNextFrame.splice(index, 1);\n        toKeepAlive.delete(callback);\n      },\n      process: frameData => {\n        if (isProcessing) {\n          flushNextFrame = true;\n          return;\n        }\n        isProcessing = true;\n        var _ref = [toRunNextFrame, toRun];\n        toRun = _ref[0];\n        toRunNextFrame = _ref[1];\n        toRunNextFrame.length = 0;\n        numToRun = toRun.length;\n        if (numToRun) {\n          for (var i = 0; i < numToRun; i++) {\n            var callback = toRun[i];\n            callback(frameData);\n            if (toKeepAlive.has(callback)) {\n              step.schedule(callback);\n              runNextFrame();\n            }\n          }\n        }\n        isProcessing = false;\n        if (flushNextFrame) {\n          flushNextFrame = false;\n          step.process(frameData);\n        }\n      }\n    };\n    return step;\n  }\n});","lineCount":68,"map":[[7,2,56,0,"Object"],[7,8,56,0],[7,9,56,0,"defineProperty"],[7,23,56,0],[7,24,56,0,"exports"],[7,31,56,0],[8,4,56,0,"enumerable"],[8,14,56,0],[9,4,56,0,"get"],[9,7,56,0],[9,18,56,0,"get"],[9,19,56,0],[10,6,56,0],[10,13,56,9,"createRenderStep"],[10,29,56,25],[11,4,56,25],[12,2,56,25],[13,2,1,0],[13,11,1,9,"createRenderStep"],[13,27,1,25,"createRenderStep"],[13,28,1,26,"runNextFrame"],[13,40,1,38],[13,42,1,40],[14,4,2,4],[14,8,2,8,"toRun"],[14,13,2,13],[14,16,2,16],[14,18,2,18],[15,4,3,4],[15,8,3,8,"toRunNextFrame"],[15,22,3,22],[15,25,3,25],[15,27,3,27],[16,4,4,4],[16,8,4,8,"numToRun"],[16,16,4,16],[16,19,4,19],[16,20,4,20],[17,4,5,4],[17,8,5,8,"isProcessing"],[17,20,5,20],[17,23,5,23],[17,28,5,28],[18,4,6,4],[18,8,6,8,"flushNextFrame"],[18,22,6,22],[18,25,6,25],[18,30,6,30],[19,4,7,4],[19,8,7,10,"toKeepAlive"],[19,19,7,21],[19,22,7,24],[19,26,7,28,"WeakSet"],[19,33,7,35],[19,34,7,36],[19,35,7,37],[20,4,8,4],[20,8,8,10,"step"],[20,12,8,14],[20,15,8,17],[21,6,9,8,"schedule"],[21,14,9,16],[21,16,9,18],[21,25,9,18,"schedule"],[21,26,9,19,"callback"],[21,34,9,27],[21,36,9,70],[22,8,9,70],[22,12,9,29,"keepAlive"],[22,21,9,38],[22,24,9,38,"arguments"],[22,33,9,38],[22,34,9,38,"length"],[22,40,9,38],[22,48,9,38,"arguments"],[22,57,9,38],[22,65,9,38,"undefined"],[22,74,9,38],[22,77,9,38,"arguments"],[22,86,9,38],[22,92,9,41],[22,97,9,46],[23,8,9,46],[23,12,9,48,"immediate"],[23,21,9,57],[23,24,9,57,"arguments"],[23,33,9,57],[23,34,9,57,"length"],[23,40,9,57],[23,48,9,57,"arguments"],[23,57,9,57],[23,65,9,57,"undefined"],[23,74,9,57],[23,77,9,57,"arguments"],[23,86,9,57],[23,92,9,60],[23,97,9,65],[24,8,10,12],[24,12,10,18,"addToCurrentFrame"],[24,29,10,35],[24,32,10,38,"immediate"],[24,41,10,47],[24,45,10,51,"isProcessing"],[24,57,10,63],[25,8,11,12],[25,12,11,18,"buffer"],[25,18,11,24],[25,21,11,27,"addToCurrentFrame"],[25,38,11,44],[25,41,11,47,"toRun"],[25,46,11,52],[25,49,11,55,"toRunNextFrame"],[25,63,11,69],[26,8,12,12],[26,12,12,16,"keepAlive"],[26,21,12,25],[26,23,13,16,"toKeepAlive"],[26,34,13,27],[26,35,13,28,"add"],[26,38,13,31],[26,39,13,32,"callback"],[26,47,13,40],[26,48,13,41],[27,8,14,12],[27,12,14,16,"buffer"],[27,18,14,22],[27,19,14,23,"indexOf"],[27,26,14,30],[27,27,14,31,"callback"],[27,35,14,39],[27,36,14,40],[27,41,14,45],[27,42,14,46],[27,43,14,47],[27,45,14,49],[28,10,15,16,"buffer"],[28,16,15,22],[28,17,15,23,"push"],[28,21,15,27],[28,22,15,28,"callback"],[28,30,15,36],[28,31,15,37],[29,10,16,16],[29,14,16,20,"addToCurrentFrame"],[29,31,16,37],[29,35,16,41,"isProcessing"],[29,47,16,53],[29,49,17,20,"numToRun"],[29,57,17,28],[29,60,17,31,"toRun"],[29,65,17,36],[29,66,17,37,"length"],[29,72,17,43],[30,8,18,12],[31,8,19,12],[31,15,19,19,"callback"],[31,23,19,27],[32,6,20,8],[32,7,20,9],[33,6,21,8,"cancel"],[33,12,21,14],[33,14,21,17,"callback"],[33,22,21,25],[33,26,21,30],[34,8,22,12],[34,12,22,18,"index"],[34,17,22,23],[34,20,22,26,"toRunNextFrame"],[34,34,22,40],[34,35,22,41,"indexOf"],[34,42,22,48],[34,43,22,49,"callback"],[34,51,22,57],[34,52,22,58],[35,8,23,12],[35,12,23,16,"index"],[35,17,23,21],[35,22,23,26],[35,23,23,27],[35,24,23,28],[35,26,24,16,"toRunNextFrame"],[35,40,24,30],[35,41,24,31,"splice"],[35,47,24,37],[35,48,24,38,"index"],[35,53,24,43],[35,55,24,45],[35,56,24,46],[35,57,24,47],[36,8,25,12,"toKeepAlive"],[36,19,25,23],[36,20,25,24,"delete"],[36,26,25,30],[36,27,25,31,"callback"],[36,35,25,39],[36,36,25,40],[37,6,26,8],[37,7,26,9],[38,6,27,8,"process"],[38,13,27,15],[38,15,27,18,"frameData"],[38,24,27,27],[38,28,27,32],[39,8,28,12],[39,12,28,16,"isProcessing"],[39,24,28,28],[39,26,28,30],[40,10,29,16,"flushNextFrame"],[40,24,29,30],[40,27,29,33],[40,31,29,37],[41,10,30,16],[42,8,31,12],[43,8,32,12,"isProcessing"],[43,20,32,24],[43,23,32,27],[43,27,32,31],[44,8,32,32],[44,12,32,32,"_ref"],[44,16,32,32],[44,19,33,38],[44,20,33,39,"toRunNextFrame"],[44,34,33,53],[44,36,33,55,"toRun"],[44,41,33,60],[44,42,33,61],[45,8,33,13,"toRun"],[45,13,33,18],[45,16,33,18,"_ref"],[45,20,33,18],[46,8,33,20,"toRunNextFrame"],[46,22,33,34],[46,25,33,34,"_ref"],[46,29,33,34],[47,8,34,12,"toRunNextFrame"],[47,22,34,26],[47,23,34,27,"length"],[47,29,34,33],[47,32,34,36],[47,33,34,37],[48,8,35,12,"numToRun"],[48,16,35,20],[48,19,35,23,"toRun"],[48,24,35,28],[48,25,35,29,"length"],[48,31,35,35],[49,8,36,12],[49,12,36,16,"numToRun"],[49,20,36,24],[49,22,36,26],[50,10,37,16],[50,15,37,21],[50,19,37,25,"i"],[50,20,37,26],[50,23,37,29],[50,24,37,30],[50,26,37,32,"i"],[50,27,37,33],[50,30,37,36,"numToRun"],[50,38,37,44],[50,40,37,46,"i"],[50,41,37,47],[50,43,37,49],[50,45,37,51],[51,12,38,20],[51,16,38,26,"callback"],[51,24,38,34],[51,27,38,37,"toRun"],[51,32,38,42],[51,33,38,43,"i"],[51,34,38,44],[51,35,38,45],[52,12,39,20,"callback"],[52,20,39,28],[52,21,39,29,"frameData"],[52,30,39,38],[52,31,39,39],[53,12,40,20],[53,16,40,24,"toKeepAlive"],[53,27,40,35],[53,28,40,36,"has"],[53,31,40,39],[53,32,40,40,"callback"],[53,40,40,48],[53,41,40,49],[53,43,40,51],[54,14,41,24,"step"],[54,18,41,28],[54,19,41,29,"schedule"],[54,27,41,37],[54,28,41,38,"callback"],[54,36,41,46],[54,37,41,47],[55,14,42,24,"runNextFrame"],[55,26,42,36],[55,27,42,37],[55,28,42,38],[56,12,43,20],[57,10,44,16],[58,8,45,12],[59,8,46,12,"isProcessing"],[59,20,46,24],[59,23,46,27],[59,28,46,32],[60,8,47,12],[60,12,47,16,"flushNextFrame"],[60,26,47,30],[60,28,47,32],[61,10,48,16,"flushNextFrame"],[61,24,48,30],[61,27,48,33],[61,32,48,38],[62,10,49,16,"step"],[62,14,49,20],[62,15,49,21,"process"],[62,22,49,28],[62,23,49,29,"frameData"],[62,32,49,38],[62,33,49,39],[63,8,50,12],[64,6,51,8],[65,4,52,4],[65,5,52,5],[66,4,53,4],[66,11,53,11,"step"],[66,15,53,15],[67,2,54,0],[68,0,54,1],[68,3]],"functionMap":{"names":["createRenderStep","step.schedule","step.cancel","step.process","<global>"],"mappings":"AAA;kBCQ;SDW;gBEC;SFK;iBGC;SHwB;CIG"},"hasCjsExports":false},"type":"js/module"}]}