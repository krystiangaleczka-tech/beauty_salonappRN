{"dependencies":[{"name":"tslib","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"8R25577gwLd3n1hFG9VYnRLV9eE=","exportNames":["*"],"imports":1}},{"name":"hey-listen","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":39,"index":86}}],"key":"5p342VF2FjgsoIiIlnJV4kmYYFQ=","exportNames":["*"],"imports":1}},{"name":"../render/utils/animation.mjs","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":87},"end":{"line":3,"column":84,"index":171}}],"key":"ycjqc5KBLd7o1NhEtdPjEuHNCJQ=","exportNames":["*"],"imports":1}},{"name":"../render/utils/setters.mjs","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":172},"end":{"line":4,"column":56,"index":228}}],"key":"K8ubOq+jO9SdY8ORrQ5QWCxRe1Y=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"animationControls\", {\n    enumerable: true,\n    get: function () {\n      return animationControls;\n    }\n  });\n  var _tslib = require(_dependencyMap[0], \"tslib\");\n  var _heyListen = require(_dependencyMap[1], \"hey-listen\");\n  var _renderUtilsAnimationMjs = require(_dependencyMap[2], \"../render/utils/animation.mjs\");\n  var _renderUtilsSettersMjs = require(_dependencyMap[3], \"../render/utils/setters.mjs\");\n  /**\n   * @public\n   */\n  function animationControls() {\n    /**\n     * Track whether the host component has mounted.\n     */\n    var hasMounted = false;\n    /**\n     * Pending animations that are started before a component is mounted.\n     * TODO: Remove this as animations should only run in effects\n     */\n    var pendingAnimations = [];\n    /**\n     * A collection of linked component animation controls.\n     */\n    var subscribers = new Set();\n    var controls = {\n      subscribe: function (visualElement) {\n        subscribers.add(visualElement);\n        return function () {\n          return void subscribers.delete(visualElement);\n        };\n      },\n      start: function (definition, transitionOverride) {\n        /**\n         * TODO: We only perform this hasMounted check because in Framer we used to\n         * encourage the ability to start an animation within the render phase. This\n         * isn't behaviour concurrent-safe so when we make Framer concurrent-safe\n         * we can ditch this.\n         */\n        if (hasMounted) {\n          var animations_1 = [];\n          subscribers.forEach(function (visualElement) {\n            animations_1.push((0, _renderUtilsAnimationMjs.animateVisualElement)(visualElement, definition, {\n              transitionOverride: transitionOverride\n            }));\n          });\n          return Promise.all(animations_1);\n        } else {\n          return new Promise(function (resolve) {\n            pendingAnimations.push({\n              animation: [definition, transitionOverride],\n              resolve: resolve\n            });\n          });\n        }\n      },\n      set: function (definition) {\n        (0, _heyListen.invariant)(hasMounted, \"controls.set() should only be called after a component has mounted. Consider calling within a useEffect hook.\");\n        return subscribers.forEach(function (visualElement) {\n          (0, _renderUtilsSettersMjs.setValues)(visualElement, definition);\n        });\n      },\n      stop: function () {\n        subscribers.forEach(function (visualElement) {\n          (0, _renderUtilsAnimationMjs.stopAnimation)(visualElement);\n        });\n      },\n      mount: function () {\n        hasMounted = true;\n        pendingAnimations.forEach(function (_a) {\n          var animation = _a.animation,\n            resolve = _a.resolve;\n          controls.start.apply(controls, (0, _tslib.__spreadArray)([], (0, _tslib.__read)(animation), false)).then(resolve);\n        });\n        return function () {\n          hasMounted = false;\n          controls.stop();\n        };\n      }\n    };\n    return controls;\n  }\n});","lineCount":91,"map":[[7,2,79,0,"Object"],[7,8,79,0],[7,9,79,0,"defineProperty"],[7,23,79,0],[7,24,79,0,"exports"],[7,31,79,0],[8,4,79,0,"enumerable"],[8,14,79,0],[9,4,79,0,"get"],[9,7,79,0],[9,18,79,0,"get"],[9,19,79,0],[10,6,79,0],[10,13,79,9,"animationControls"],[10,30,79,26],[11,4,79,26],[12,2,79,26],[13,2,1,0],[13,6,1,0,"_tslib"],[13,12,1,0],[13,15,1,0,"require"],[13,22,1,0],[13,23,1,0,"_dependencyMap"],[13,37,1,0],[14,2,2,0],[14,6,2,0,"_heyListen"],[14,16,2,0],[14,19,2,0,"require"],[14,26,2,0],[14,27,2,0,"_dependencyMap"],[14,41,2,0],[15,2,3,0],[15,6,3,0,"_renderUtilsAnimationMjs"],[15,30,3,0],[15,33,3,0,"require"],[15,40,3,0],[15,41,3,0,"_dependencyMap"],[15,55,3,0],[16,2,4,0],[16,6,4,0,"_renderUtilsSettersMjs"],[16,28,4,0],[16,31,4,0,"require"],[16,38,4,0],[16,39,4,0,"_dependencyMap"],[16,53,4,0],[17,2,6,0],[18,0,7,0],[19,0,8,0],[20,2,9,0],[20,11,9,9,"animationControls"],[20,28,9,26,"animationControls"],[20,29,9,26],[20,31,9,29],[21,4,10,4],[22,0,11,0],[23,0,12,0],[24,4,13,4],[24,8,13,8,"hasMounted"],[24,18,13,18],[24,21,13,21],[24,26,13,26],[25,4,14,4],[26,0,15,0],[27,0,16,0],[28,0,17,0],[29,4,18,4],[29,8,18,8,"pendingAnimations"],[29,25,18,25],[29,28,18,28],[29,30,18,30],[30,4,19,4],[31,0,20,0],[32,0,21,0],[33,4,22,4],[33,8,22,8,"subscribers"],[33,19,22,19],[33,22,22,22],[33,26,22,26,"Set"],[33,29,22,29],[33,30,22,30],[33,31,22,31],[34,4,23,4],[34,8,23,8,"controls"],[34,16,23,16],[34,19,23,19],[35,6,24,8,"subscribe"],[35,15,24,17],[35,17,24,19],[35,26,24,19,"subscribe"],[35,27,24,29,"visualElement"],[35,40,24,42],[35,42,24,44],[36,8,25,12,"subscribers"],[36,19,25,23],[36,20,25,24,"add"],[36,23,25,27],[36,24,25,28,"visualElement"],[36,37,25,41],[36,38,25,42],[37,8,26,12],[37,15,26,19],[37,27,26,31],[38,10,26,33],[38,17,26,40],[38,22,26,45,"subscribers"],[38,33,26,56],[38,34,26,57,"delete"],[38,40,26,63],[38,41,26,64,"visualElement"],[38,54,26,77],[38,55,26,78],[39,8,26,80],[39,9,26,81],[40,6,27,8],[40,7,27,9],[41,6,28,8,"start"],[41,11,28,13],[41,13,28,15],[41,22,28,15,"start"],[41,23,28,25,"definition"],[41,33,28,35],[41,35,28,37,"transitionOverride"],[41,53,28,55],[41,55,28,57],[42,8,29,12],[43,0,30,0],[44,0,31,0],[45,0,32,0],[46,0,33,0],[47,0,34,0],[48,8,35,12],[48,12,35,16,"hasMounted"],[48,22,35,26],[48,24,35,28],[49,10,36,16],[49,14,36,20,"animations_1"],[49,26,36,32],[49,29,36,35],[49,31,36,37],[50,10,37,16,"subscribers"],[50,21,37,27],[50,22,37,28,"forEach"],[50,29,37,35],[50,30,37,36],[50,40,37,46,"visualElement"],[50,53,37,59],[50,55,37,61],[51,12,38,20,"animations_1"],[51,24,38,32],[51,25,38,33,"push"],[51,29,38,37],[51,30,38,38],[51,34,38,38,"animateVisualElement"],[51,58,38,58],[51,59,38,58,"animateVisualElement"],[51,79,38,58],[51,81,38,59,"visualElement"],[51,94,38,72],[51,96,38,74,"definition"],[51,106,38,84],[51,108,38,86],[52,14,39,24,"transitionOverride"],[52,32,39,42],[52,34,39,44,"transitionOverride"],[53,12,40,20],[53,13,40,21],[53,14,40,22],[53,15,40,23],[54,10,41,16],[54,11,41,17],[54,12,41,18],[55,10,42,16],[55,17,42,23,"Promise"],[55,24,42,30],[55,25,42,31,"all"],[55,28,42,34],[55,29,42,35,"animations_1"],[55,41,42,47],[55,42,42,48],[56,8,43,12],[56,9,43,13],[56,15,44,17],[57,10,45,16],[57,17,45,23],[57,21,45,27,"Promise"],[57,28,45,34],[57,29,45,35],[57,39,45,45,"resolve"],[57,46,45,52],[57,48,45,54],[58,12,46,20,"pendingAnimations"],[58,29,46,37],[58,30,46,38,"push"],[58,34,46,42],[58,35,46,43],[59,14,47,24,"animation"],[59,23,47,33],[59,25,47,35],[59,26,47,36,"definition"],[59,36,47,46],[59,38,47,48,"transitionOverride"],[59,56,47,66],[59,57,47,67],[60,14,48,24,"resolve"],[60,21,48,31],[60,23,48,33,"resolve"],[61,12,49,20],[61,13,49,21],[61,14,49,22],[62,10,50,16],[62,11,50,17],[62,12,50,18],[63,8,51,12],[64,6,52,8],[64,7,52,9],[65,6,53,8,"set"],[65,9,53,11],[65,11,53,13],[65,20,53,13,"set"],[65,21,53,23,"definition"],[65,31,53,33],[65,33,53,35],[66,8,54,12],[66,12,54,12,"invariant"],[66,22,54,21],[66,23,54,21,"invariant"],[66,32,54,21],[66,34,54,22,"hasMounted"],[66,44,54,32],[66,46,54,34],[66,157,54,145],[66,158,54,146],[67,8,55,12],[67,15,55,19,"subscribers"],[67,26,55,30],[67,27,55,31,"forEach"],[67,34,55,38],[67,35,55,39],[67,45,55,49,"visualElement"],[67,58,55,62],[67,60,55,64],[68,10,56,16],[68,14,56,16,"setValues"],[68,36,56,25],[68,37,56,25,"setValues"],[68,46,56,25],[68,48,56,26,"visualElement"],[68,61,56,39],[68,63,56,41,"definition"],[68,73,56,51],[68,74,56,52],[69,8,57,12],[69,9,57,13],[69,10,57,14],[70,6,58,8],[70,7,58,9],[71,6,59,8,"stop"],[71,10,59,12],[71,12,59,14],[71,21,59,14,"stop"],[71,22,59,14],[71,24,59,26],[72,8,60,12,"subscribers"],[72,19,60,23],[72,20,60,24,"forEach"],[72,27,60,31],[72,28,60,32],[72,38,60,42,"visualElement"],[72,51,60,55],[72,53,60,57],[73,10,61,16],[73,14,61,16,"stopAnimation"],[73,38,61,29],[73,39,61,29,"stopAnimation"],[73,52,61,29],[73,54,61,30,"visualElement"],[73,67,61,43],[73,68,61,44],[74,8,62,12],[74,9,62,13],[74,10,62,14],[75,6,63,8],[75,7,63,9],[76,6,64,8,"mount"],[76,11,64,13],[76,13,64,15],[76,22,64,15,"mount"],[76,23,64,15],[76,25,64,27],[77,8,65,12,"hasMounted"],[77,18,65,22],[77,21,65,25],[77,25,65,29],[78,8,66,12,"pendingAnimations"],[78,25,66,29],[78,26,66,30,"forEach"],[78,33,66,37],[78,34,66,38],[78,44,66,48,"_a"],[78,46,66,50],[78,48,66,52],[79,10,67,16],[79,14,67,20,"animation"],[79,23,67,29],[79,26,67,32,"_a"],[79,28,67,34],[79,29,67,35,"animation"],[79,38,67,44],[80,12,67,46,"resolve"],[80,19,67,53],[80,22,67,56,"_a"],[80,24,67,58],[80,25,67,59,"resolve"],[80,32,67,66],[81,10,68,16,"controls"],[81,18,68,24],[81,19,68,25,"start"],[81,24,68,30],[81,25,68,31,"apply"],[81,30,68,36],[81,31,68,37,"controls"],[81,39,68,45],[81,41,68,47],[81,45,68,47,"__spreadArray"],[81,51,68,60],[81,52,68,60,"__spreadArray"],[81,65,68,60],[81,67,68,61],[81,69,68,63],[81,71,68,65],[81,75,68,65,"__read"],[81,81,68,71],[81,82,68,71,"__read"],[81,88,68,71],[81,90,68,72,"animation"],[81,99,68,81],[81,100,68,82],[81,102,68,84],[81,107,68,89],[81,108,68,90],[81,109,68,91],[81,110,68,92,"then"],[81,114,68,96],[81,115,68,97,"resolve"],[81,122,68,104],[81,123,68,105],[82,8,69,12],[82,9,69,13],[82,10,69,14],[83,8,70,12],[83,15,70,19],[83,27,70,31],[84,10,71,16,"hasMounted"],[84,20,71,26],[84,23,71,29],[84,28,71,34],[85,10,72,16,"controls"],[85,18,72,24],[85,19,72,25,"stop"],[85,23,72,29],[85,24,72,30],[85,25,72,31],[86,8,73,12],[86,9,73,13],[87,6,74,8],[88,4,75,4],[88,5,75,5],[89,4,76,4],[89,11,76,11,"controls"],[89,19,76,19],[90,2,77,0],[91,0,77,1],[91,3]],"functionMap":{"names":["<global>","animationControls","controls.subscribe","<anonymous>","controls.start","subscribers.forEach$argument_0","Promise$argument_0","controls.set","controls.stop","controls.mount","pendingAnimations.forEach$argument_0"],"mappings":"AAA;ACQ;mBCe;mBCE,8DD;SDC;eGC;oCCS;iBDI;mCEI;iBFK;SHE;aMC;uCFE;aEE;SNC;cOC;gCHC;aGE;SPC;eQC;sCCE;aDG;mBNC;aMG;SRC;CDG"},"hasCjsExports":false},"type":"js/module"}]}